{"version":3,"file":"tooltip.js","sources":["../../src/tooltip/tooltip.tsx"],"sourcesContent":["import Vue from 'vue';\nimport { prefix } from '../config';\nimport props from './props';\nimport popupProps from '../popup/props';\nimport Popup from '../popup/popup';\nimport { PopupProps, PopupVisibleChangeContext } from '../popup';\nimport { ClassName } from '../common';\nimport { renderTNodeJSX, renderContent } from '../utils/render-tnode';\n\ntype PopupInstanceType = InstanceType<typeof Popup>;\n\nexport default Vue.extend({\n  name: 'TTooltip',\n  components: { Popup },\n  props: {\n    ...popupProps,\n    ...props,\n  },\n  data() {\n    return {\n      timer: null,\n      tooltipVisible: false,\n    };\n  },\n  computed: {\n    tooltipOverlayClassName(): ClassName {\n      return [`${prefix}-tooltip`, { [`${prefix}-tooltip--${this.theme}`]: this.theme }, this.overlayClassName];\n    },\n  },\n  watch: {\n    visible(visible) {\n      // clear timer when tooltip is hidden before duration ends\n      if (this.timer && !visible) {\n        clearTimeout(this.timer);\n        this.timer = null;\n      }\n    },\n  },\n  created() {\n    if (this.duration && this.visible) {\n      this.timer = setTimeout(() => {\n        this.$emit('visible-change', false);\n        clearTimeout(this.timer);\n        this.timer = null;\n      }, this.duration);\n    }\n  },\n  methods: {\n    onTipVisibleChange(val: boolean, ctx?: PopupVisibleChangeContext) {\n      // 因 props={this.getPopupProps()} 已经透传 onVisibleChange props，此处不再需要使用 emitEvent\n      if (this.timer && ctx?.trigger !== 'document') return;\n      this.$emit('visible-change', val);\n    },\n\n    getPopupProps(): PopupProps {\n      const r: PopupProps = {\n        showArrow: true,\n        ...this.$props,\n        content: () => renderTNodeJSX(this, 'content'),\n        default: () => renderContent(this, 'default', 'triggerElement'),\n        overlayClassName: this.tooltipOverlayClassName,\n      };\n      // delete r.visible;\n      return r;\n    },\n    updatedTooltip() {\n      this.$refs.popup && (this.$refs.popup as PopupInstanceType).updatePopper();\n    },\n  },\n  render() {\n    return (\n      <Popup\n        ref=\"popup\"\n        visible={this.visible}\n        props={this.getPopupProps()}\n        on={{\n          'visible-change': this.onTipVisibleChange,\n        }}\n      ></Popup>\n    );\n  },\n});\n"],"names":["Vue","extend","name","components","Popup","props","popupProps","data","timer","tooltipVisible","computed","tooltipOverlayClassName","prefix","theme","overlayClassName","watch","visible","clearTimeout","created","duration","setTimeout","$emit","methods","onTipVisibleChange","val","ctx","trigger","getPopupProps","r","showArrow","$props","content","renderTNodeJSX","renderContent","updatedTooltip","$refs","popup","updatePopper","render","_mergeJSXProps"],"mappings":"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"}