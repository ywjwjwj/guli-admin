{"version":3,"file":"common.js","sources":["../../../src/table/util/common.ts"],"sourcesContent":["import isFunction from 'lodash/isFunction';\nimport isString from 'lodash/isString';\nimport { PrimaryTableCol, TableRowData } from '../type';\n\nexport function toString(obj: any): string {\n  return Object.prototype.toString\n    .call(obj)\n    .slice(8, -1)\n    .toLowerCase();\n}\n\nexport function debounce<T = any>(fn: Function, delay = 200): () => void {\n  let timer: ReturnType<typeof setTimeout>;\n  return function newFn(this: T, ...args: Array<any>): void {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const context = this;\n    clearTimeout(timer);\n    timer = setTimeout(() => {\n      fn.apply(context, args);\n    }, delay);\n  };\n}\n\nexport function filterDataByIds(\n  data: Array<object> = [],\n  ids: Array<string | number> = [],\n  byId = 'id',\n): Array<object> {\n  return data.filter((d: Record<string, any> = {}) => ids.includes(d[byId]));\n}\n\nexport const INNER_PRE_NAME = '@@inner-';\n\nexport enum SCROLL_DIRECTION {\n  X = 'x',\n  Y = 'y',\n  UNKNOWN = 'unknown',\n}\n\nlet preScrollLeft: any;\nlet preScrollTop: any;\n\nexport const getScrollDirection = (\n  scrollLeft: number,\n  scrollTop: number,\n): SCROLL_DIRECTION => {\n  let direction = SCROLL_DIRECTION.UNKNOWN;\n  if (preScrollTop !== scrollTop) {\n    direction = SCROLL_DIRECTION.Y;\n  } else if (preScrollLeft !== scrollLeft) {\n    direction = SCROLL_DIRECTION.X;\n  }\n  preScrollTop = scrollTop;\n  preScrollLeft = scrollLeft;\n  return direction;\n};\n\nexport const getRecord = (record: Record<any, any>) => {\n  if (!record) {\n    return record;\n  }\n  const result = {};\n  Object.keys(record).forEach((key) => {\n    const descriptor = Object.getOwnPropertyDescriptor(record, key);\n    descriptor && Reflect.defineProperty(result, key, {\n      set(val) {\n        descriptor.set(val);\n      },\n      get() {\n        console.warn('The parameter `record` will be deprecated, please use `row` instead');\n        return descriptor.get();\n      },\n    });\n  });\n  return result;\n};\n\n// 该方法主要用于排序、过滤等需要调整表头的功能\nexport function getTitle(vm: Vue, column: PrimaryTableCol, colIndex: number) {\n  let result = null;\n  if (isFunction(column.title)) {\n    result = column.title(vm.$createElement, { col: column, colIndex });\n  } else if (isString(column.title)) {\n    result = vm.$scopedSlots[column.title]\n      ? vm.$scopedSlots[column.title](null)\n      : column.title;\n  } else if (isFunction(column.render)) {\n    result = column.render(vm.$createElement, {\n      type: 'title',\n      col: column,\n      colIndex,\n      row: undefined,\n      rowIndex: undefined,\n    });\n  }\n  return result;\n}\n\nexport interface GetCellParams<T extends TableRowData = TableRowData> {\n  row: T;\n  rowIndex: number;\n  col: PrimaryTableCol;\n  colIndex: number;\n}\n\n// 该方法主要用于设置单元格（树形结构等功能会使用）\nexport function getCell(vm: Vue, p: GetCellParams) {\n  const { col, row } = p;\n  let result = null;\n  if (isFunction(col.cell)) {\n    result = col.cell(vm.$createElement, { ...p });\n  } else if (isString(col.cell)) {\n    result = vm.$scopedSlots[col.cell]\n      ? vm.$scopedSlots[col.cell](p)\n      : row[col.colKey];\n  } else if (isFunction(col.render)) {\n    result = col.render(vm.$createElement, {\n      type: 'cell',\n      ...p,\n    });\n  }\n  return result || row[col.colKey];\n}\n\nexport function isRowSelectedDisabled(selectColumn: PrimaryTableCol, row: Record<string, any>, rowIndex: number): boolean {\n  let disabled = isFunction(selectColumn.disabled)\n    ? selectColumn.disabled({ row, rowIndex })\n    : selectColumn.disabled;\n  if (selectColumn.checkProps) {\n    if (isFunction(selectColumn.checkProps)) {\n      disabled = disabled || selectColumn.checkProps({ row, rowIndex }).disabled;\n    } else if (selectColumn.checkProps === 'object') {\n      disabled = disabled || selectColumn.checkProps.disabled;\n    }\n  }\n  return !!disabled;\n}\n"],"names":["toString","obj","Object","prototype","call","slice","toLowerCase","debounce","fn","delay","timer","newFn","args","context","clearTimeout","setTimeout","apply","filterDataByIds","data","ids","byId","filter","d","includes","INNER_PRE_NAME","SCROLL_DIRECTION","SCROLL_DIRECTION2","preScrollLeft","preScrollTop","getScrollDirection","scrollLeft","scrollTop","direction","getRecord","record","result","keys","forEach","key","descriptor","getOwnPropertyDescriptor","Reflect","defineProperty","set","val","get","console","warn","getTitle","vm","column","colIndex","isFunction","title","$createElement","col","isString","$scopedSlots","render","type","row","rowIndex","getCell","p","cell","colKey","isRowSelectedDisabled","selectColumn","disabled","checkProps"],"mappings":"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"}