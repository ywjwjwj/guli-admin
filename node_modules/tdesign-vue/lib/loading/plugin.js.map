{"version":3,"file":"plugin.js","sources":["../../src/loading/plugin.tsx"],"sourcesContent":["import Vue from 'vue';\nimport LoadingComponent from './loading';\nimport { prefix } from '../config';\nimport { getAttach, removeClass } from '../utils/dom';\nimport { TdLoadingProps, LoadingInstance, LoadingMethod } from './type';\n\nconst lockClass = `${prefix}-loading--lock`;\n\nlet fullScreenLoadingInstance: LoadingInstance = null;\n\nfunction createLoading(options: TdLoadingProps): LoadingInstance {\n  const props = { ...options };\n  const loading = new LoadingComponent({\n    propsData: { ...props },\n  }).$mount();\n\n  const attach = getAttach(props.attach);\n  if (attach) {\n    attach.appendChild(loading.$el);\n  } else {\n    console.error('attach is not exist');\n  }\n\n  const loadingInstance: LoadingInstance = {\n    hide: () => {\n      loading.loading = false;\n      loading.$el.parentNode.removeChild(loading.$el);\n    },\n  };\n\n  return loadingInstance;\n}\n\nfunction produceLoading(props: boolean | TdLoadingProps): LoadingInstance {\n  // 全屏加载\n  if (props === true) {\n    fullScreenLoadingInstance = createLoading({\n      fullscreen: true,\n      loading: true,\n      attach: 'body',\n    });\n    return fullScreenLoadingInstance;\n  }\n  if (props === false) {\n    // 销毁全屏实例\n    removeClass(document.body, lockClass);\n    fullScreenLoadingInstance.hide();\n    fullScreenLoadingInstance = null;\n    return;\n  }\n  return createLoading(props);\n}\n\nexport type LoadingPluginType = Vue.PluginObject<undefined> & LoadingMethod;\n\nexport const LoadingPlugin: LoadingPluginType = produceLoading as LoadingPluginType;\n\nLoadingPlugin.install = () => {\n  // 这样定义后，可以通过 this.$loading 调用插件\n  Vue.prototype.$loading = produceLoading;\n};\n\nexport default LoadingPlugin;\n\ndeclare module 'vue/types/vue' {\n  // Bind to `this` keyword\n  interface Vue {\n    $loading: LoadingMethod;\n  }\n}\n"],"names":["lockClass","prefix","fullScreenLoadingInstance","createLoading","options","props","loading","LoadingComponent","propsData","$mount","attach","getAttach","appendChild","$el","console","error","loadingInstance","hide","parentNode","removeChild","produceLoading","fullscreen","removeClass","document","body","LoadingPlugin","install","Vue","prototype","$loading"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA,IAAMA,SAAS,GAAMC,EAAAA,CAAAA,MAAAA,CAAAA,aAAN,EAAf,gBAAA,CAAA,CAAA;AACA,IAAIC,yBAAyB,GAAG,IAAhC,CAAA;;AACA,SAASC,aAAT,CAAuBC,OAAvB,EAAgC;AAC9B,EAAMC,IAAAA,KAAK,GAAQD,aAAAA,CAAAA,EAAAA,EAAAA,OAAR,CAAX,CAAA;;AACA,EAAA,IAAME,OAAO,GAAG,IAAIC,0BAAJ,CAAqB;AACnCC,IAAAA,SAAS,oBAAOH,KAAP,CAAA;AAD0B,GAArB,CAAA,CAEbI,MAFa,EAAhB,CAAA;AAGA,EAAA,IAAMC,MAAM,GAAGC,mBAAS,CAACN,KAAK,CAACK,MAAP,CAAxB,CAAA;;AACA,EAAA,IAAIA,MAAJ,EAAY;AACVA,IAAAA,MAAM,CAACE,WAAP,CAAmBN,OAAO,CAACO,GAA3B,CAAA,CAAA;AACD,GAFD,MAEO;AACLC,IAAAA,OAAO,CAACC,KAAR,CAAc,qBAAd,CAAA,CAAA;AACD,GAAA;;AACD,EAAA,IAAMC,eAAe,GAAG;AACtBC,IAAAA,IAAI,EAAE,SAAM,IAAA,GAAA;AACVX,MAAAA,OAAO,CAACA,OAAR,GAAkB,KAAlB,CAAA;AACAA,MAAAA,OAAO,CAACO,GAAR,CAAYK,UAAZ,CAAuBC,WAAvB,CAAmCb,OAAO,CAACO,GAA3C,CAAA,CAAA;AACD,KAAA;AAJqB,GAAxB,CAAA;AAMA,EAAA,OAAOG,eAAP,CAAA;AACD,CAAA;;AACD,SAASI,cAAT,CAAwBf,KAAxB,EAA+B;AAC7B,EAAIA,IAAAA,KAAK,KAAK,IAAd,EAAoB;AAClBH,IAAAA,yBAAyB,GAAGC,aAAa,CAAC;AACxCkB,MAAAA,UAAU,EAAE,IAD4B;AAExCf,MAAAA,OAAO,EAAE,IAF+B;AAGxCI,MAAAA,MAAM,EAAE,MAAA;AAHgC,KAAD,CAAzC,CAAA;AAKA,IAAA,OAAOR,yBAAP,CAAA;AACD,GAAA;;AACD,EAAIG,IAAAA,KAAK,KAAK,KAAd,EAAqB;AACnBiB,IAAAA,qBAAW,CAACC,QAAQ,CAACC,IAAV,EAAgBxB,SAAhB,CAAX,CAAA;AACAE,IAAAA,yBAAyB,CAACe,IAA1B,EAAA,CAAA;AACAf,IAAAA,yBAAyB,GAAG,IAA5B,CAAA;AACA,IAAA,OAAA;AACD,GAAA;;AACD,EAAOC,OAAAA,aAAa,CAACE,KAAD,CAApB,CAAA;AACD,CAAA;;AACM,IAAMoB,aAAa,GAAGL,eAAtB;;AACPK,aAAa,CAACC,OAAd,GAAwB,YAAM;AAC5BC,EAAAA,uBAAG,CAACC,SAAJ,CAAcC,QAAd,GAAyBT,cAAzB,CAAA;AACD,CAFD;;;;;"}