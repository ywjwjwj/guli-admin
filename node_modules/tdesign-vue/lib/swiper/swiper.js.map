{"version":3,"file":"swiper.js","sources":["../../src/swiper/swiper.tsx"],"sourcesContent":["import Vue, { VNode } from 'vue';\nimport { emitEvent } from '../utils/event';\nimport { prefix } from '../config';\nimport props from './props';\nimport { SwiperChangeSource, TdSwiperProps } from '.';\n\nconst name = `${prefix}-swiper`;\n\nexport default Vue.extend({\n  name: 'TSwiper',\n  props: { ...props },\n  data() {\n    return {\n      // 是否可见，关闭后置为false\n      visible: true,\n      // 轮播序列\n      index: 0,\n      // 自动轮播定时器handler\n      timeoutHandler: null,\n    };\n  },\n  computed: {\n    items(): VNode[] {\n      return (this.$slots.default || []).filter((child) => {\n        const node = child as VNode;\n        return node.componentOptions && node.componentOptions.tag === `${prefix}-swiper-item`;\n      });\n    },\n  },\n  watch: {\n    interval: {\n      handler() {\n        this.swiperTo(this.index, ''); // 重置定时器\n      },\n      immediate: true,\n    },\n  },\n  render(): VNode {\n    const swiperClass = [\n      `${name}`,\n      {\n        [`${prefix}-is-hidden`]: !this.visible,\n      },\n    ];\n    return (\n      <div class={swiperClass} onMouseenter={this.clearTimer} onMouseleave={this.setTimer}>\n        {this.renderContent()}\n        {this.renderTrigger()}\n      </div>\n    );\n  },\n  methods: {\n    renderContent(): VNode {\n      let wraperStyles = {};\n      if (this.direction === 'vertical') {\n        wraperStyles = {\n          height: `${this.items.length * 100}%`,\n          transform: `translate(0,${(-this.index * 100) / this.items.length}%)`,\n          transition: `transform ${this.duration / 1000}s`,\n        };\n      } else {\n        wraperStyles = {\n          width: `${this.items.length * 100}%`,\n          transform: `translate(${(-this.index * 100) / this.items.length}%,0)`,\n          transition: `transform ${this.duration / 1000}s`,\n        };\n      }\n      return (\n        <div class={`${name}__content`}>\n          <div class={`${name}__swiper-wrap--${this.direction}`} style={wraperStyles}>\n            {this.items}\n          </div>\n        </div>\n      );\n    },\n\n    renderTrigger(): VNode {\n      const index = this.index % this.items.length;\n      return (\n        <ul class=\"t-swiper__trigger-wrap\">\n          {this.items.map((_: VNode, i: number) => (\n            <li class={i === index ? 't-swiper__trigger--active' : ''} onclick={() => this.swiperTo(i, 'touch')}></li>\n          ))}\n        </ul>\n      );\n    },\n\n    swiperToNext(source: SwiperChangeSource) {\n      const number = this.index + 1;\n      this.swiperTo(number, source);\n      if (source) {\n        emitEvent<Parameters<TdSwiperProps['onChange']>>(this, 'change', number, { source });\n      }\n    },\n\n    swiperTo(index: number, source: SwiperChangeSource) {\n      const findIndex = this.items.length === 0 ? 0 : index % this.items.length;\n      if (this.timeoutHandler) {\n        this.clearTimer();\n      }\n      this.index = findIndex;\n      if (this.interval > 0) {\n        this.timeoutHandler = setTimeout(() => {\n          this.swiperToNext(source);\n        }, this.interval);\n      }\n    },\n\n    setTimer() {\n      if (this.interval > 0) {\n        this.timeoutHandler = Number(\n          setTimeout(() => {\n            this.clearTimer();\n            this.swiperToNext('autoplay');\n          }, this.interval),\n        );\n      }\n    },\n\n    clearTimer() {\n      clearTimeout(this.timeoutHandler);\n      this.timeoutHandler = null;\n    },\n  },\n});\n"],"names":["name","prefix","Vue","extend","props","data","visible","index","timeoutHandler","computed","items","$slots","filter","child","node","componentOptions","tag","watch","interval","handler","swiperTo","immediate","render","swiperClass","_defineProperty","clearTimer","setTimer","renderContent","renderTrigger","methods","wraperStyles","direction","height","length","transform","transition","duration","width","map","_","i","swiperToNext","source","number","emitEvent","findIndex","setTimeout","Number","clearTimeout"],"mappings":"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"}