{"version":3,"file":"local-receiver.js","sources":["../../src/locale/local-receiver.ts"],"sourcesContent":["import Vue, { VueConstructor } from 'vue';\nimport { prefix } from '../config';\nimport { Locale, ComponentLocale, LocalRule } from './type';\nimport defaultLocale from './zh_CN';\n\nconst name = `${prefix}-locale-receiver`;\n\nexport interface Placement {\n  [propName: string]: string | number;\n}\n\nexport interface LocalComponent extends Vue {\n  globalLocale: Locale;\n}\n\nexport default function getLocalReceiverMixins<BasicComponent extends Vue>(componentName: string) { // eslint-disable-line\n  return (Vue as VueConstructor<LocalComponent & BasicComponent>).extend({\n    name,\n    inject: {\n      globalLocale: {\n        default: undefined,\n      },\n    },\n\n    computed: {\n      locale(): ComponentLocale {\n        const defaultData = defaultLocale[componentName];\n        if (this.globalLocale && this.globalLocale[componentName]) {\n          return {\n            ...defaultData,\n            ...this.globalLocale[componentName],\n          };\n        }\n        return defaultData;\n      },\n    },\n\n    methods: {\n      t(pattern: LocalRule<Placement>, placement?: Placement): string {\n        if (typeof pattern === 'string') {\n          if (!placement) return pattern;\n          const regx = /\\{\\s*([\\w-]+)\\s*\\}/g;\n          const translated = pattern.replace(regx, (match, key) => {\n            if (placement) {\n              return String(placement[key]);\n            }\n            return '';\n          });\n          return translated;\n        }\n        if (typeof pattern === 'function') {\n          return pattern(placement);\n        }\n        return '';\n      },\n    },\n  });\n}\n"],"names":["name","prefix","getLocalReceiverMixins","componentName","Vue","extend","inject","globalLocale","computed","locale","defaultData","defaultLocale","methods","t","pattern","placement","regx","translated","replace","match","key","String"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA,IAAMA,IAAI,GAAMC,EAAAA,CAAAA,MAAAA,CAAAA,aAAN,EAAV,kBAAA,CAAA,CAAA;AACe,SAASC,sBAAT,CAAgCC,aAAhC,EAA+C;AAC5D,EAAOC,OAAAA,uBAAG,CAACC,MAAJ,CAAW;AAChBL,IAAAA,IAAI,EAAJA,IADgB;AAEhBM,IAAAA,MAAM,EAAE;AACNC,MAAAA,YAAY,EAAE;AACZ,QAAA,SAAA,EAAS,KAAK,CAAA;AADF,OAAA;AADR,KAFQ;AAOhBC,IAAAA,QAAQ,EAAE;AACRC,MAAAA,MADQ,EACC,SAAA,MAAA,GAAA;AACP,QAAA,IAAMC,WAAW,GAAGC,uBAAa,CAACR,aAAD,CAAjC,CAAA;;AACA,QAAI,IAAA,IAAA,CAAKI,YAAL,IAAqB,IAAA,CAAKA,YAAL,CAAkBJ,aAAlB,CAAzB,EAA2D;AACzD,UAAA,OAAA,aAAA,CAAA,aAAA,CAAA,EAAA,EACKO,WADL,CAEK,EAAA,IAAA,CAAKH,YAAL,CAAkBJ,aAAlB,CAFL,CAAA,CAAA;AAID,SAAA;;AACD,QAAA,OAAOO,WAAP,CAAA;AACD,OAAA;AAVO,KAPM;AAmBhBE,IAAAA,OAAO,EAAE;AACPC,MAAAA,CADO,EAAA,SAAA,CAAA,CACLC,OADK,EACIC,SADJ,EACe;AACpB,QAAA,IAAI,OAAOD,OAAP,KAAmB,QAAvB,EAAiC;AAC/B,UAAA,IAAI,CAACC,SAAL,EACE,OAAOD,OAAP,CAAA;AACF,UAAME,IAAAA,IAAI,GAAG,qBAAb,CAAA;AACA,UAAA,IAAMC,UAAU,GAAGH,OAAO,CAACI,OAAR,CAAgBF,IAAhB,EAAsB,UAACG,KAAD,EAAQC,GAAR,EAAgB;AACvD,YAAA,IAAIL,SAAJ,EAAe;AACb,cAAA,OAAOM,MAAM,CAACN,SAAS,CAACK,GAAD,CAAV,CAAb,CAAA;AACD,aAAA;;AACD,YAAA,OAAO,EAAP,CAAA;AACD,WALkB,CAAnB,CAAA;AAMA,UAAA,OAAOH,UAAP,CAAA;AACD,SAAA;;AACD,QAAA,IAAI,OAAOH,OAAP,KAAmB,UAAvB,EAAmC;AACjC,UAAOA,OAAAA,OAAO,CAACC,SAAD,CAAd,CAAA;AACD,SAAA;;AACD,QAAA,OAAO,EAAP,CAAA;AACD,OAAA;AAlBM,KAAA;AAnBO,GAAX,CAAP,CAAA;AAwCD;;;;"}