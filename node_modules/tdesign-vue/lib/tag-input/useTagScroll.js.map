{"version":3,"file":"useTagScroll.js","sources":["../../src/tag-input/useTagScroll.ts"],"sourcesContent":["/**\n * 当标签数量过多时，输入框显示不下，则需要滚动查看，以下为滚动逻辑\n * 如果标签过多时的处理方式，是标签省略，则不需要此功能\n */\n\nimport {\n  onMounted, onUnmounted, ref, toRefs,\n} from '@vue/composition-api';\nimport { TdTagInputProps } from './type';\n\nexport default function useTagScroll(props: TdTagInputProps) {\n  const tagInputRef = ref();\n  const { excessTagsDisplayType, readonly, disabled } = toRefs(props);\n  // 允许向右滚动的最大距离\n  const scrollDistance = ref(0);\n  const scrollElement = ref<HTMLElement>();\n  const mouseEnterTimer = ref();\n\n  const updateScrollElement = (element: HTMLElement) => {\n    const inputElement = element.children[0] as HTMLElement;\n    scrollElement.value = inputElement;\n  };\n\n  const updateScrollDistance = () => {\n    scrollDistance.value = scrollElement.value.scrollWidth - scrollElement.value.clientWidth;\n  };\n\n  const scrollTo = (distance: number) => {\n    scrollElement.value?.scroll({ left: distance, behavior: 'smooth' });\n  };\n\n  const scrollToRight = () => {\n    updateScrollDistance();\n    scrollTo(scrollDistance.value);\n  };\n\n  const scrollToLeft = () => {\n    scrollTo(0);\n  };\n\n  // TODO：MAC 电脑横向滚动，Windows 纵向滚动。当前只处理了横向滚动\n  const onWheel = ({ e }: { e: WheelEvent }) => {\n    if (readonly.value || disabled.value) return;\n    if (!scrollElement.value) return;\n    if (e.deltaX > 0) {\n      const distance = Math.min(scrollElement.value.scrollLeft + 120, scrollDistance.value);\n      scrollTo(distance);\n    } else {\n      const distance = Math.max(scrollElement.value.scrollLeft - 120, 0);\n      scrollTo(distance);\n    }\n  };\n\n  // 鼠标 hover，自动滑动到最右侧，以便输入新标签\n  const scrollToRightOnEnter = () => {\n    if (excessTagsDisplayType.value !== 'scroll') return;\n    // 一闪而过的 mousenter 不需要执行\n    mouseEnterTimer.value = setTimeout(() => {\n      scrollToRight();\n      clearTimeout(mouseEnterTimer.value);\n    }, 100);\n  };\n\n  const scrollToLeftOnLeave = () => {\n    if (excessTagsDisplayType.value !== 'scroll') return;\n    scrollTo(0);\n    clearTimeout(mouseEnterTimer.value);\n  };\n\n  const init = () => {\n    const element = tagInputRef.value?.$el;\n    if (!element) return;\n    updateScrollElement(element);\n  };\n\n  const clear = () => {\n    clearTimeout(mouseEnterTimer.value);\n  };\n\n  onMounted(init);\n\n  onUnmounted(clear);\n\n  return {\n    tagInputRef,\n    scrollElement,\n    scrollDistance,\n    scrollTo,\n    scrollToRight,\n    scrollToLeft,\n    updateScrollElement,\n    updateScrollDistance,\n    onWheel,\n    scrollToRightOnEnter,\n    scrollToLeftOnLeave,\n  };\n}\n"],"names":["useTagScroll","props","tagInputRef","ref","toRefs","excessTagsDisplayType","readonly","disabled","scrollDistance","scrollElement","mouseEnterTimer","updateScrollElement","element","inputElement","children","value","updateScrollDistance","scrollWidth","clientWidth","scrollTo","distance","scroll","left","behavior","scrollToRight","scrollToLeft","onWheel","e","deltaX","Math","min","scrollLeft","max","scrollToRightOnEnter","setTimeout","clearTimeout","scrollToLeftOnLeave","init","$el","clear","onMounted","onUnmounted"],"mappings":"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"}