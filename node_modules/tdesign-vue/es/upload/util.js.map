{"version":3,"file":"util.js","sources":["../../src/upload/util.ts"],"sourcesContent":["import uniqWith from 'lodash/uniqWith';\nimport { prefix } from '../config';\nimport { UploadFile } from './type';\n\nexport const UPLOAD_NAME = `${prefix}-upload`;\n\nexport function returnFileSize(number: number) {\n  if (number < 1024) {\n    return `${number} Bytes`;\n  }\n  if (number >= 1024 && number < 1048576) {\n    return `${(number / 1024).toFixed(1)} KB`;\n  }\n  if (number >= 1048576) {\n    return `${(number / 1048576).toFixed(1)} MB`;\n  }\n}\n\nexport function getCurrentDate() {\n  const d = new Date();\n  let month: string | number = d.getMonth() + 1;\n  month = month < 10 ? `0${month}` : month;\n  return `${d.getFullYear()}-${month}-${d.getDate()} ${d.getHours()}:${d.getMinutes()}:${d.getSeconds()}`;\n}\n/**\n * 缩略文件名 ABCDEFG => ABC...FG\n * @param inputName 文件名\n * @param leftCount 左边长度\n * @param rightcount 右边长度\n * @returns 缩略后的文件名\n */\nexport function abridgeName(inputName: string, leftCount = 5, rightcount = 7): string {\n  const name = inputName;\n  let leftLength = 0;\n  let rightLength = 0;\n  for (let i = 0; i < name.length; i++) {\n    const w = name[i];\n    const isCn = escape(w).indexOf('%u') === 0;\n    if (i < leftCount * 2 && leftLength < leftCount) {\n      isCn ? (leftLength += 1) : (leftLength += 2);\n    } else if (i > i - rightcount && rightLength < rightcount) {\n      isCn ? (rightLength += 1) : (rightLength += 2);\n    }\n  }\n  return name.replace(new RegExp(`^(.{${leftLength}})(.+)(.{${rightLength}})$`), '$1…$3');\n}\n/**\n * 重复数组检查\n * @param files Array\n * @param key string default name\n * @returns Array of files\n */\nexport function dedupeFile(files: Array<UploadFile>, key = 'name'): any {\n  return uniqWith(files, (val1, val2) => val1[key] === val2[key]);\n}\n"],"names":["UPLOAD_NAME","prefix","returnFileSize","number","toFixed","getCurrentDate","d","Date","month","getMonth","getFullYear","getDate","getHours","getMinutes","getSeconds","abridgeName","inputName","leftCount","rightcount","name","leftLength","rightLength","i","length","w","isCn","escape","indexOf","replace","RegExp","dedupeFile","files","key","uniqWith","val1","val2"],"mappings":"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"}