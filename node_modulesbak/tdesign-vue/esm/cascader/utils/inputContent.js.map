{"version":3,"file":"inputContent.js","sources":["../../../src/cascader/utils/inputContent.ts"],"sourcesContent":["import isFunction from 'lodash/isFunction';\nimport isEmpty from 'lodash/isEmpty';\nimport {\n  TreeNode, CascaderContextType, TreeNodeValue, CascaderProps,\n} from '../interface';\n\n/**\n * icon Class\n * @param prefix\n * @param CLASSNAMES\n * @param cascaderContext\n * @returns\n */\nexport function getCloseIconClass(prefix: string, CLASSNAMES: any, cascaderContext: CascaderContextType) {\n  const { visible, disabled } = cascaderContext;\n  return [\n    `${prefix}-cascader__icon`,\n    {\n      [CLASSNAMES.STATUS.visible]: visible,\n      [CLASSNAMES.STATUS.disabled]: disabled,\n    },\n  ];\n}\n\n/**\n * icon Class\n * @param prefix\n * @param CLASSNAMES\n * @param cascaderContext\n * @returns\n */\nexport function getFakeArrowIconClass(prefix: string, CLASSNAMES: any, cascaderContext: CascaderContextType) {\n  const { disabled } = cascaderContext;\n  return [\n    `${prefix}-cascader__icon`,\n    {\n      [CLASSNAMES.STATUS.disabled]: disabled,\n    },\n  ];\n}\n\n/**\n * Cascader外显div class\n * @param prefix\n * @param CLASSNAMES\n * @param cascaderContext\n * @returns\n */\nexport function getCascaderInnerClasses(prefix: string, CLASSNAMES: any, cascaderContext: CascaderContextType) {\n  const {\n    disabled, visible, size, multiple,\n  } = cascaderContext;\n  return [\n    `${prefix}-cascader`,\n    {\n      [CLASSNAMES.STATUS.disabled]: disabled,\n      [CLASSNAMES.STATUS.active]: visible,\n      [CLASSNAMES.SIZE[size]]: size,\n      [`${prefix}-cascader--multiple`]: multiple,\n    },\n  ];\n}\n\n/**\n * closeIcon 是否显示\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getCloseShow(isHover: boolean, cascaderContext: CascaderContextType) {\n  const {\n    value, disabled, clearable, visible,\n  } = cascaderContext;\n  return !!(!visible && clearable && isHover && !disabled && !isEmpty(value));\n}\n\n/**\n * Placeholder 是否显示\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getPlaceholderShow(\n  cascaderContext: CascaderContextType,\n  singleContent: string,\n  multipleContent: TreeNode[],\n) {\n  const { filterable, visible, multiple } = cascaderContext;\n  const valEmpty = !(multiple ? multipleContent.length : singleContent);\n  if (filterable) {\n    return valEmpty && !visible;\n  }\n  return valEmpty;\n}\n\n/**\n * 单选状态下内容\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getSingleContent(cascaderContext: CascaderContextType) {\n  const {\n    value, multiple, treeStore, showAllLevels, setValue,\n  } = cascaderContext;\n  if (multiple || !value) return '';\n\n  if (Array.isArray(value)) return '';\n  const node = treeStore && treeStore.getNodes(value as TreeNodeValue | TreeNode);\n  if (!(node && node.length)) {\n    if (value) {\n      setValue(multiple ? [] : '', 'invalid-value');\n    }\n    return '';\n  }\n  const path = node && node[0].getPath();\n  if (path && path.length) {\n    return showAllLevels ? path.map((node: TreeNode) => node.label).join(' / ') : path[path.length - 1].label;\n  }\n  return value as string;\n}\n\n/**\n * 多选状态下选中内容\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getMultipleContent(cascaderContext: CascaderContextType) {\n  const { value, multiple, treeStore } = cascaderContext;\n\n  if (!multiple) return [];\n  if (multiple && !Array.isArray(value)) return [];\n\n  const node = treeStore && treeStore.getNodes(value as TreeNodeValue | TreeNode);\n  if (!node) return [];\n\n  const path = (value as TreeNodeValue[]).map((item: TreeNodeValue) => {\n    const node = treeStore.getNodes(item);\n    return node[0];\n  });\n  if (value && (value as TreeNodeValue[]).length) {\n    return path && path.length ? path : (value as TreeNode[]);\n  }\n  return [];\n}\n\n/**\n * 点击popup outside副作用\n * @param ref\n * @param cascaderContext\n * @param event\n * @returns\n */\nexport function outerClickListenerEffect(\n  ref: HTMLElement,\n  cascaderContext: CascaderContextType,\n  event: MouseEvent | TouchEvent,\n) {\n  const { visible, setVisible } = cascaderContext;\n  if (!ref || ref.contains(event.target as Node)) {\n    return;\n  }\n\n  if (visible) {\n    setVisible(false);\n  }\n}\n\n/**\n * closeIcon点击副作用\n * @param cascaderContext\n */\nexport function closeIconClickEffect(cascaderContext: CascaderContextType) {\n  const {\n    setVisible, multiple, setExpend, setValue,\n  } = cascaderContext;\n\n  setVisible(false);\n\n  // 手动设置的展开需要去除\n  if (multiple) {\n    setExpend([]);\n  }\n\n  setValue(multiple ? [] : '', 'clear');\n}\n\n/**\n * tag 关闭按钮点击副作用\n * @param cascaderContext\n */\nexport function handleRemoveTagEffect(\n  cascaderContext: CascaderContextType,\n  node: TreeNode,\n  onRemove: CascaderProps['onRemove'],\n) {\n  const {\n    disabled, setValue, valueType, treeStore,\n  } = cascaderContext;\n\n  if (disabled) return;\n  const checked = node.setChecked(!node.isChecked());\n  // 处理不同数据类型\n  const resValue = valueType === 'single'\n    ? checked\n    : checked.map((val) => treeStore\n      .getNode(val)\n      .getPath()\n      .map((item) => item.value));\n\n  setValue(resValue, 'unchecked', node.getModel());\n  if (isFunction(onRemove)) {\n    onRemove({ value: checked, node: node as any });\n  }\n}\n\n/**\n * 外显content点击副作用\n * @param cascaderContext\n */\nexport function innerContentClickEffect(cascaderContext: CascaderContextType) {\n  const {\n    setVisible, visible, filterActive, disabled,\n  } = cascaderContext;\n\n  if (!disabled) {\n    if (visible && filterActive) return; // input filter is active\n    setVisible(!visible);\n  }\n}\n"],"names":["getCloseIconClass","prefix","CLASSNAMES","cascaderContext","visible","disabled","STATUS","getFakeArrowIconClass","getCascaderInnerClasses","size","multiple","active","SIZE","getCloseShow","isHover","value","clearable","isEmpty","getPlaceholderShow","singleContent","multipleContent","filterable","valEmpty","length","getSingleContent","treeStore","showAllLevels","setValue","Array","isArray","node","getNodes","path","getPath","map","node2","label","join","getMultipleContent","item","outerClickListenerEffect","ref","event","setVisible","contains","target","closeIconClickEffect","setExpend","handleRemoveTagEffect","onRemove","valueType","checked","setChecked","isChecked","resValue","val","getNode","getModel","isFunction","innerContentClickEffect","filterActive"],"mappings":";;;;;;;;;;AAEO,SAASA,iBAAT,CAA2BC,MAA3B,EAAmCC,UAAnC,EAA+CC,eAA/C,EAAgE;AAAA,EAAA,IAAA,IAAA,CAAA;;AACrE,EAAA,IAAQC,OAAR,GAA8BD,eAA9B,CAAQC,OAAR;AAAA,MAAiBC,QAAjB,GAA8BF,eAA9B,CAAiBE,QAAjB,CAAA;AACA,EAAA,OAAO,WACFJ,MADE,EAAA,iBAAA,CAAA,GAAA,IAAA,GAAA,EAAA,EAAA,eAAA,CAAA,IAAA,EAGFC,UAAU,CAACI,MAAX,CAAkBF,OAHhB,EAG0BA,OAH1B,CAAA,EAAA,eAAA,CAAA,IAAA,EAIFF,UAAU,CAACI,MAAX,CAAkBD,QAJhB,EAI2BA,QAJ3B,CAAP,EAAA,IAAA,EAAA,CAAA;AAOD,CAAA;AACM,SAASE,qBAAT,CAA+BN,MAA/B,EAAuCC,UAAvC,EAAmDC,eAAnD,EAAoE;AACzE,EAAA,IAAQE,QAAR,GAAqBF,eAArB,CAAQE,QAAR,CAAA;AACA,EAAO,OAAA,CAAA,EAAA,CAAA,MAAA,CACFJ,MADE,EAAA,iBAAA,CAAA,EAAA,eAAA,CAAA,EAAA,EAGFC,UAAU,CAACI,MAAX,CAAkBD,QAHhB,EAG2BA,QAH3B,CAAP,CAAA,CAAA;AAMD,CAAA;AACM,SAASG,uBAAT,CAAiCP,MAAjC,EAAyCC,UAAzC,EAAqDC,eAArD,EAAsE;AAAA,EAAA,IAAA,KAAA,CAAA;;AAC3E,EAAA,IACEE,QADF,GAKIF,eALJ,CACEE,QADF;AAAA,MAEED,OAFF,GAKID,eALJ,CAEEC,OAFF;AAAA,MAGEK,IAHF,GAKIN,eALJ,CAGEM,IAHF;AAAA,MAIEC,QAJF,GAKIP,eALJ,CAIEO,QAJF,CAAA;AAMA,EAAA,OAAO,CACFT,EAAAA,CAAAA,MAAAA,CAAAA,MADE,EAGFC,WAAAA,CAAAA,GAAAA,KAAAA,GAAAA,EAAAA,EAAAA,eAAAA,CAAAA,KAAAA,EAAAA,UAAU,CAACI,MAAX,CAAkBD,QAHhB,EAG2BA,QAH3B,CAIFH,EAAAA,eAAAA,CAAAA,KAAAA,EAAAA,UAAU,CAACI,MAAX,CAAkBK,MAJhB,EAIyBP,OAJzB,CAAA,EAAA,eAAA,CAAA,KAAA,EAKFF,UAAU,CAACU,IAAX,CAAgBH,IAAhB,CALE,EAKsBA,IALtB,CAAA,EAAA,eAAA,CAAA,KAAA,EAAA,EAAA,CAAA,MAAA,CAMCR,MAND,EAAA,qBAAA,CAAA,EAM+BS,QAN/B,CAAP,EAAA,KAAA,EAAA,CAAA;AASD,CAAA;AACM,SAASG,YAAT,CAAsBC,OAAtB,EAA+BX,eAA/B,EAAgD;AACrD,EAAA,IACEY,KADF,GAKIZ,eALJ,CACEY,KADF;AAAA,MAEEV,QAFF,GAKIF,eALJ,CAEEE,QAFF;AAAA,MAGEW,SAHF,GAKIb,eALJ,CAGEa,SAHF;AAAA,MAIEZ,OAJF,GAKID,eALJ,CAIEC,OAJF,CAAA;AAMA,EAAA,OAAO,CAAC,EAAE,CAACA,OAAD,IAAYY,SAAZ,IAAyBF,OAAzB,IAAoC,CAACT,QAArC,IAAiD,CAACY,OAAO,CAACF,KAAD,CAA3D,CAAR,CAAA;AACD,CAAA;AACM,SAASG,kBAAT,CAA4Bf,eAA5B,EAA6CgB,aAA7C,EAA4DC,eAA5D,EAA6E;AAClF,EAAA,IAAQC,UAAR,GAA0ClB,eAA1C,CAAQkB,UAAR;AAAA,MAAoBjB,OAApB,GAA0CD,eAA1C,CAAoBC,OAApB;AAAA,MAA6BM,QAA7B,GAA0CP,eAA1C,CAA6BO,QAA7B,CAAA;AACA,EAAMY,IAAAA,QAAQ,GAAG,EAAEZ,QAAQ,GAAGU,eAAe,CAACG,MAAnB,GAA4BJ,aAAtC,CAAjB,CAAA;;AACA,EAAA,IAAIE,UAAJ,EAAgB;AACd,IAAOC,OAAAA,QAAQ,IAAI,CAAClB,OAApB,CAAA;AACD,GAAA;;AACD,EAAA,OAAOkB,QAAP,CAAA;AACD,CAAA;AACM,SAASE,gBAAT,CAA0BrB,eAA1B,EAA2C;AAChD,EAAA,IACEY,KADF,GAMIZ,eANJ,CACEY,KADF;AAAA,MAEEL,QAFF,GAMIP,eANJ,CAEEO,QAFF;AAAA,MAGEe,SAHF,GAMItB,eANJ,CAGEsB,SAHF;AAAA,MAIEC,aAJF,GAMIvB,eANJ,CAIEuB,aAJF;AAAA,MAKEC,QALF,GAMIxB,eANJ,CAKEwB,QALF,CAAA;AAOA,EAAA,IAAIjB,QAAQ,IAAI,CAACK,KAAjB,EACE,OAAO,EAAP,CAAA;AACF,EAAIa,IAAAA,KAAK,CAACC,OAAN,CAAcd,KAAd,CAAJ,EACE,OAAO,EAAP,CAAA;AACF,EAAMe,IAAAA,IAAI,GAAGL,SAAS,IAAIA,SAAS,CAACM,QAAV,CAAmBhB,KAAnB,CAA1B,CAAA;;AACA,EAAA,IAAI,EAAEe,IAAI,IAAIA,IAAI,CAACP,MAAf,CAAJ,EAA4B;AAC1B,IAAA,IAAIR,KAAJ,EAAW;AACTY,MAAAA,QAAQ,CAACjB,QAAQ,GAAG,EAAH,GAAQ,EAAjB,EAAqB,eAArB,CAAR,CAAA;AACD,KAAA;;AACD,IAAA,OAAO,EAAP,CAAA;AACD,GAAA;;AACD,EAAMsB,IAAAA,IAAI,GAAGF,IAAI,IAAIA,IAAI,CAAC,CAAD,CAAJ,CAAQG,OAAR,EAArB,CAAA;;AACA,EAAA,IAAID,IAAI,IAAIA,IAAI,CAACT,MAAjB,EAAyB;AACvB,IAAA,OAAOG,aAAa,GAAGM,IAAI,CAACE,GAAL,CAAS,UAACC,KAAD,EAAA;AAAA,MAAWA,OAAAA,KAAK,CAACC,KAAjB,CAAA;AAAA,KAAT,CAAiCC,CAAAA,IAAjC,CAAsC,KAAtC,CAAH,GAAkDL,IAAI,CAACA,IAAI,CAACT,MAAL,GAAc,CAAf,CAAJ,CAAsBa,KAA5F,CAAA;AACD,GAAA;;AACD,EAAA,OAAOrB,KAAP,CAAA;AACD,CAAA;AACM,SAASuB,kBAAT,CAA4BnC,eAA5B,EAA6C;AAClD,EAAA,IAAQY,KAAR,GAAuCZ,eAAvC,CAAQY,KAAR;AAAA,MAAeL,QAAf,GAAuCP,eAAvC,CAAeO,QAAf;AAAA,MAAyBe,SAAzB,GAAuCtB,eAAvC,CAAyBsB,SAAzB,CAAA;AACA,EAAA,IAAI,CAACf,QAAL,EACE,OAAO,EAAP,CAAA;AACF,EAAIA,IAAAA,QAAQ,IAAI,CAACkB,KAAK,CAACC,OAAN,CAAcd,KAAd,CAAjB,EACE,OAAO,EAAP,CAAA;AACF,EAAMe,IAAAA,IAAI,GAAGL,SAAS,IAAIA,SAAS,CAACM,QAAV,CAAmBhB,KAAnB,CAA1B,CAAA;AACA,EAAA,IAAI,CAACe,IAAL,EACE,OAAO,EAAP,CAAA;AACF,EAAME,IAAAA,IAAI,GAAGjB,KAAK,CAACmB,GAAN,CAAU,UAACK,IAAD,EAAU;AAC/B,IAAA,IAAMJ,KAAK,GAAGV,SAAS,CAACM,QAAV,CAAmBQ,IAAnB,CAAd,CAAA;AACA,IAAOJ,OAAAA,KAAK,CAAC,CAAD,CAAZ,CAAA;AACD,GAHY,CAAb,CAAA;;AAIA,EAAA,IAAIpB,KAAK,IAAIA,KAAK,CAACQ,MAAnB,EAA2B;AACzB,IAAOS,OAAAA,IAAI,IAAIA,IAAI,CAACT,MAAb,GAAsBS,IAAtB,GAA6BjB,KAApC,CAAA;AACD,GAAA;;AACD,EAAA,OAAO,EAAP,CAAA;AACD,CAAA;AACM,SAASyB,wBAAT,CAAkCC,GAAlC,EAAuCtC,eAAvC,EAAwDuC,KAAxD,EAA+D;AACpE,EAAA,IAAQtC,OAAR,GAAgCD,eAAhC,CAAQC,OAAR;AAAA,MAAiBuC,UAAjB,GAAgCxC,eAAhC,CAAiBwC,UAAjB,CAAA;;AACA,EAAI,IAAA,CAACF,GAAD,IAAQA,GAAG,CAACG,QAAJ,CAAaF,KAAK,CAACG,MAAnB,CAAZ,EAAwC;AACtC,IAAA,OAAA;AACD,GAAA;;AACD,EAAA,IAAIzC,OAAJ,EAAa;AACXuC,IAAAA,UAAU,CAAC,KAAD,CAAV,CAAA;AACD,GAAA;AACF,CAAA;AACM,SAASG,oBAAT,CAA8B3C,eAA9B,EAA+C;AACpD,EAAA,IACEwC,UADF,GAKIxC,eALJ,CACEwC,UADF;AAAA,MAEEjC,QAFF,GAKIP,eALJ,CAEEO,QAFF;AAAA,MAGEqC,SAHF,GAKI5C,eALJ,CAGE4C,SAHF;AAAA,MAIEpB,QAJF,GAKIxB,eALJ,CAIEwB,QAJF,CAAA;AAMAgB,EAAAA,UAAU,CAAC,KAAD,CAAV,CAAA;;AACA,EAAA,IAAIjC,QAAJ,EAAc;AACZqC,IAAAA,SAAS,CAAC,EAAD,CAAT,CAAA;AACD,GAAA;;AACDpB,EAAAA,QAAQ,CAACjB,QAAQ,GAAG,EAAH,GAAQ,EAAjB,EAAqB,OAArB,CAAR,CAAA;AACD,CAAA;AACM,SAASsC,qBAAT,CAA+B7C,eAA/B,EAAgD2B,IAAhD,EAAsDmB,QAAtD,EAAgE;AACrE,EAAA,IACE5C,QADF,GAKIF,eALJ,CACEE,QADF;AAAA,MAEEsB,QAFF,GAKIxB,eALJ,CAEEwB,QAFF;AAAA,MAGEuB,SAHF,GAKI/C,eALJ,CAGE+C,SAHF;AAAA,MAIEzB,SAJF,GAKItB,eALJ,CAIEsB,SAJF,CAAA;AAMA,EAAA,IAAIpB,QAAJ,EACE,OAAA;AACF,EAAM8C,IAAAA,OAAO,GAAGrB,IAAI,CAACsB,UAAL,CAAgB,CAACtB,IAAI,CAACuB,SAAL,EAAjB,CAAhB,CAAA;AACA,EAAA,IAAMC,QAAQ,GAAGJ,SAAS,KAAK,QAAd,GAAyBC,OAAzB,GAAmCA,OAAO,CAACjB,GAAR,CAAY,UAACqB,GAAD,EAAA;AAAA,IAAS9B,OAAAA,SAAS,CAAC+B,OAAV,CAAkBD,GAAlB,CAAuBtB,CAAAA,OAAvB,EAAiCC,CAAAA,GAAjC,CAAqC,UAACK,IAAD,EAAA;AAAA,MAAUA,OAAAA,IAAI,CAACxB,KAAf,CAAA;AAAA,KAArC,CAAT,CAAA;AAAA,GAAZ,CAApD,CAAA;AACAY,EAAAA,QAAQ,CAAC2B,QAAD,EAAW,WAAX,EAAwBxB,IAAI,CAAC2B,QAAL,EAAxB,CAAR,CAAA;;AACA,EAAA,IAAIC,UAAU,CAACT,QAAD,CAAd,EAA0B;AACxBA,IAAAA,QAAQ,CAAC;AAAElC,MAAAA,KAAK,EAAEoC,OAAT;AAAkBrB,MAAAA,IAAI,EAAJA,IAAAA;AAAlB,KAAD,CAAR,CAAA;AACD,GAAA;AACF,CAAA;AACM,SAAS6B,uBAAT,CAAiCxD,eAAjC,EAAkD;AACvD,EAAA,IACEwC,UADF,GAKIxC,eALJ,CACEwC,UADF;AAAA,MAEEvC,OAFF,GAKID,eALJ,CAEEC,OAFF;AAAA,MAGEwD,YAHF,GAKIzD,eALJ,CAGEyD,YAHF;AAAA,MAIEvD,QAJF,GAKIF,eALJ,CAIEE,QAJF,CAAA;;AAMA,EAAI,IAAA,CAACA,QAAL,EAAe;AACb,IAAID,IAAAA,OAAO,IAAIwD,YAAf,EACE,OAAA;AACFjB,IAAAA,UAAU,CAAC,CAACvC,OAAF,CAAV,CAAA;AACD,GAAA;AACF;;;;"}