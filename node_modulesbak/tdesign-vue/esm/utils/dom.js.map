{"version":3,"file":"dom.js","sources":["../../src/utils/dom.ts"],"sourcesContent":["/**\n * Thanks to https://spothero.com/static/main/uniform/docs-js/module-DOMUtils.html\n */\n/* eslint-disable no-param-reassign */\nimport Vue from 'vue';\nimport raf from 'raf';\nimport isString from 'lodash/isString';\nimport { easeInOutCubic, EasingFunction } from './easing';\nimport { ScrollContainer, ScrollContainerElement } from '../common';\n\nconst isServer = Vue.prototype.$isServer || typeof window === 'undefined';\n\nconst trim = (str: string): string => (str || '').replace(/^[\\s\\uFEFF]+|[\\s\\uFEFF]+$/g, '');\n\nexport const on = ((): any => {\n  if (!isServer && document.addEventListener) {\n    return (element: Node, event: string, handler: EventListenerOrEventListenerObject): any => {\n      if (element && event && handler) {\n        element.addEventListener(event, handler, false);\n        return () => off(element, event, handler);\n      }\n    };\n  }\n  return (element: Node, event: string, handler: EventListenerOrEventListenerObject): any => {\n    if (element && event && handler) {\n      (element as any).attachEvent(`on${event}`, handler);\n      return () => off(element, event, handler);\n    }\n  };\n})();\n\nexport const off = ((): any => {\n  if (!isServer && document.removeEventListener) {\n    return (element: Node, event: string, handler: EventListenerOrEventListenerObject): any => {\n      if (element && event) {\n        element.removeEventListener(event, handler, false);\n      }\n    };\n  }\n  return (element: Node, event: string, handler: EventListenerOrEventListenerObject): any => {\n    if (element && event) {\n      (element as any).detachEvent(`on${event}`, handler);\n    }\n  };\n})();\n\nexport function once(element: Node, event: string, handler: EventListenerOrEventListenerObject) {\n  const handlerFn = typeof handler === 'function' ? handler : handler.handleEvent;\n  const callback = (evt: any) => {\n    handlerFn(evt);\n    off(element, event, callback);\n  };\n\n  on(element, event, callback);\n}\n\nexport function hasClass(el: Element, cls: string): any {\n  if (!el || !cls) return false;\n  if (cls.indexOf(' ') !== -1) throw new Error('className should not contain space.');\n  if (el.classList) {\n    return el.classList.contains(cls);\n  }\n  return ` ${el.className} `.indexOf(` ${cls} `) > -1;\n}\n\nexport function addClass(el: Element, cls: string): any {\n  if (!el) return;\n  let curClass = el.className;\n  const classes = (cls || '').split(' ');\n\n  for (let i = 0, j = classes.length; i < j; i++) {\n    const clsName = classes[i];\n    if (!clsName) continue;\n\n    if (el.classList) {\n      el.classList.add(clsName);\n    } else if (!hasClass(el, clsName)) {\n      curClass += ` ${clsName}`;\n    }\n  }\n  if (!el.classList) {\n    el.className = curClass;\n  }\n}\n\nexport function removeClass(el: Element, cls: string): any {\n  if (!el || !cls) return;\n  const classes = cls.split(' ');\n  let curClass = ` ${el.className} `;\n\n  for (let i = 0, j = classes.length; i < j; i++) {\n    const clsName = classes[i];\n    if (!clsName) continue;\n\n    if (el.classList) {\n      el.classList.remove(clsName);\n    } else if (hasClass(el, clsName)) {\n      curClass = curClass.replace(` ${clsName} `, ' ');\n    }\n  }\n  if (!el.classList) {\n    el.className = trim(curClass);\n  }\n}\n\nexport const getAttach = (node: any): HTMLElement => {\n  const attachNode = typeof node === 'function' ? node() : node;\n  if (!attachNode) {\n    return document.body;\n  }\n  if (isString(attachNode)) {\n    return document.querySelector(attachNode);\n  }\n  if (attachNode instanceof HTMLElement) {\n    return attachNode;\n  }\n  return document.body;\n};\n\n/**\n * 获取滚动容器\n * 因为document不存在scroll等属性, 因此排除document\n * window | HTMLElement\n * @param {ScrollContainerElement} [container='body']\n * @returns {ScrollContainer}\n */\nexport const getScrollContainer = (container: ScrollContainer = 'body'): ScrollContainerElement => {\n  if (isString(container)) {\n    return document.querySelector(container) as HTMLElement;\n  }\n  if (typeof container === 'function') {\n    return container();\n  }\n  return container;\n};\n\n/**\n * 返回是否window对象\n *\n * @export\n * @param {any} obj\n * @returns\n */\nfunction isWindow(obj: any) {\n  return obj && obj === obj.window;\n}\n\ntype ScrollTarget = HTMLElement | Window | Document;\n\n/**\n * 获取滚动距离\n *\n * @export\n * @param {ScrollTarget} target\n * @param {boolean} isLeft true为获取scrollLeft, false为获取scrollTop\n * @returns {number}\n */\nexport function getScroll(target: ScrollTarget, isLeft?: boolean): number {\n  // node环境或者target为空\n  if (typeof window === 'undefined' || !target) {\n    return 0;\n  }\n  const method = isLeft ? 'scrollLeft' : 'scrollTop';\n  let result = 0;\n  if (isWindow(target)) {\n    result = (target as Window)[isLeft ? 'pageXOffset' : 'pageYOffset'];\n  } else if (target instanceof Document) {\n    result = target.documentElement[method];\n  } else if (target) {\n    result = (target as HTMLElement)[method];\n  }\n  return result;\n}\ninterface ScrollTopOptions {\n  container?: ScrollTarget;\n  duration?: number;\n  easing?: EasingFunction;\n}\n\nexport function scrollTo(target: number, opt: ScrollTopOptions) {\n  const { container = window, duration = 450, easing = easeInOutCubic } = opt;\n  const scrollTop = getScroll(container);\n  const startTime = Date.now();\n  return new Promise((res) => {\n    const fnc = () => {\n      const timestamp = Date.now();\n      const time = timestamp - startTime;\n      const nextScrollTop = easing(Math.min(time, duration), scrollTop, target, duration);\n      if (isWindow(container)) {\n        (container as Window).scrollTo(window.pageXOffset, nextScrollTop);\n      } else if (container instanceof HTMLDocument || container.constructor.name === 'HTMLDocument') {\n        (container as HTMLDocument).documentElement.scrollTop = nextScrollTop;\n      } else {\n        (container as HTMLElement).scrollTop = nextScrollTop;\n      }\n      if (time < duration) {\n        raf(fnc);\n      } else {\n        // 由于上面步骤设置了scrollTop, 滚动事件可能未触发完毕\n        // 此时应该在下一帧再执行res\n        raf(res);\n      }\n    };\n    raf(fnc);\n  });\n}\n\nfunction containerDom(parent: Vue | Element | Iterable<any> | ArrayLike<any>, child: any): boolean {\n  if (parent && child) {\n    let pNode = child;\n    while (pNode) {\n      if (parent === pNode) {\n        return true;\n      }\n      const { parentNode } = pNode;\n      pNode = parentNode;\n    }\n  }\n  return false;\n}\nexport const clickOut = (els: Vue | Element | Iterable<any> | ArrayLike<any>, cb: Function): void => {\n  on(document, 'click', (event: { target: Element }) => {\n    if (Array.isArray(els)) {\n      const isFlag = Array.from(els).every((item) => containerDom(item, event.target) === false);\n      isFlag && cb && cb();\n    } else {\n      if (containerDom(els, event.target)) {\n        return false;\n      }\n      cb && cb();\n    }\n  });\n};\n\n// 用于判断节点内容是否溢出\nexport const isNodeOverflow = (ele: Vue | Element | (Vue | Element)[]): boolean => {\n  const { clientWidth = 0, scrollWidth = 0 } = ele as Element & { clientWidth: number; scrollWidth: number };\n\n  if (scrollWidth > clientWidth) {\n    return true;\n  }\n  return false;\n};\n\n// 将子元素selected滚动到父元素parentEle的可视范围内\nexport const scrollSelectedIntoView = (parentEle: HTMLElement, selected: HTMLElement) => {\n  // 服务端不处理\n  if (Vue.prototype.$isServer) return;\n  // selected不存在或selected父元素不为parentEle则不处理\n  if (!selected || selected.offsetParent !== parentEle) {\n    parentEle.scrollTop = 0;\n    return;\n  }\n  const selectedTop = selected.offsetTop;\n  const selectedBottom = selectedTop + selected.offsetHeight;\n  const parentScrollTop = parentEle.scrollTop;\n  const parentViewBottom = parentScrollTop + parentEle.clientHeight;\n  if (selectedTop < parentScrollTop) {\n    // selected元素滚动过了，则将其向下滚动到可视范围顶部\n    parentEle.scrollTop = selectedTop;\n  } else if (selectedBottom > parentViewBottom) {\n    // selected元素未滚动到，则将其向上滚动到可视范围底部\n    parentEle.scrollTop = selectedBottom - parentEle.clientHeight;\n  }\n};\n\nexport const removeDom = (el: HTMLElement) => {\n  if (el.remove) {\n    el.remove();\n  } else {\n    // ie\n    el.parentNode.removeChild(el);\n  }\n};\n"],"names":["isServer","Vue","prototype","$isServer","window","trim","str","replace","on","document","addEventListener","element","event","handler","off","attachEvent","removeEventListener","detachEvent","once","handlerFn","handleEvent","callback","evt","hasClass","el","cls","indexOf","Error","classList","contains","className","addClass","curClass","classes","split","i","j","length","clsName","add","removeClass","remove","getAttach","node","attachNode","body","isString","querySelector","HTMLElement","getScrollContainer","container","isWindow","obj","getScroll","target","isLeft","method","result","Document","documentElement","scrollTo","opt","duration","easing","easeInOutCubic","scrollTop","startTime","Date","now","Promise","res","fnc","timestamp","time","nextScrollTop","Math","min","pageXOffset","HTMLDocument","constructor","name","raf","containerDom","parent","child","pNode","parentNode","clickOut","els","cb","Array","isArray","isFlag","from","every","item","isNodeOverflow","ele","clientWidth","scrollWidth","scrollSelectedIntoView","parentEle","selected","offsetParent","selectedTop","offsetTop","selectedBottom","offsetHeight","parentScrollTop","parentViewBottom","clientHeight","removeDom","removeChild"],"mappings":"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"}