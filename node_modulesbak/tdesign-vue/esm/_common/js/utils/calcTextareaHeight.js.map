{"version":3,"file":"calcTextareaHeight.js","sources":["../../../../src/_common/js/utils/calcTextareaHeight.ts"],"sourcesContent":["import { calculateNodeSize } from './helper';\n\ntype CalculateStyleType = {\n  height?: string,\n  minHeight?: string\n};\n\ntype LimitType = number | null;\n\nconst TEXTAREA_STYLE = `\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important\n`;\n\nlet hiddenTextarea: HTMLTextAreaElement;\n\nfunction calcTextareaHeight(\n  targetElement: HTMLTextAreaElement,\n  minRows: LimitType = 1,\n  maxRows: LimitType = null,\n): CalculateStyleType {\n  if (!hiddenTextarea) {\n    hiddenTextarea = document.createElement('textarea');\n    document.body.appendChild(hiddenTextarea);\n  }\n\n  const {\n    paddingSize,\n    borderSize,\n    boxSizing,\n    sizingStyle,\n  } = calculateNodeSize(targetElement);\n\n  hiddenTextarea.setAttribute('style', `${sizingStyle};${TEXTAREA_STYLE}`);\n  hiddenTextarea.value = targetElement.value || targetElement.placeholder || '';\n\n  let height = hiddenTextarea.scrollHeight;\n  const result: CalculateStyleType = {};\n  const isBorderbox = boxSizing === 'border-box';\n  const isContentbox = boxSizing === 'content-box';\n\n  if (isBorderbox) {\n    height += borderSize;\n  } else if (isContentbox) {\n    height -= paddingSize;\n  }\n\n  hiddenTextarea.value = '';\n  const singleRowHeight = hiddenTextarea.scrollHeight - paddingSize;\n  hiddenTextarea?.parentNode?.removeChild(hiddenTextarea);\n  // @ts-ignore\n  hiddenTextarea = null;\n\n  const calcHeight = (rows: number) => {\n    let rowsHeight = singleRowHeight * rows;\n    if (isBorderbox) {\n      rowsHeight = rowsHeight + paddingSize + borderSize;\n    }\n    return rowsHeight;\n  };\n\n  if (minRows !== null) {\n    const minHeight = calcHeight(minRows);\n    height = Math.max(minHeight, height);\n    result.minHeight = `${minHeight}px`;\n  }\n  if (maxRows !== null) {\n    height = Math.min(calcHeight(maxRows), height);\n  }\n  result.height = `${height}px`;\n  return result;\n}\n\nexport default calcTextareaHeight;\n"],"names":["TEXTAREA_STYLE","hiddenTextarea","calcTextareaHeight","targetElement","minRows","maxRows","document","createElement","body","appendChild","calculateNodeSize","paddingSize","borderSize","boxSizing","sizingStyle","setAttribute","value","placeholder","height","scrollHeight","result","isBorderbox","isContentbox","singleRowHeight","parentNode","removeChild","calcHeight","rows","rowsHeight","minHeight","Math","max","min"],"mappings":"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"}