{"version":3,"file":"image.js","sources":["../../src/upload/image.tsx"],"sourcesContent":["import Vue, { PropType } from 'vue';\nimport { AddIcon, DeleteIcon, BrowseIcon } from 'tdesign-icons-vue';\nimport { UploadFile } from './type';\nimport TLoading from '../loading';\nimport { UploadRemoveOptions } from './interface';\nimport { UPLOAD_NAME } from './util';\nimport props from './props';\nimport { prefix } from '../config';\nimport CLASSNAMES from '../utils/classnames';\n\nexport default Vue.extend({\n  name: 'TImageUpload',\n\n  components: {\n    AddIcon,\n    DeleteIcon,\n    BrowseIcon,\n    TLoading,\n  },\n  props: {\n    showUploadProgress: props.showUploadProgress,\n    files: {\n      type: Array as PropType<Array<UploadFile>>,\n    },\n    loadingFile: {\n      type: Object as PropType<UploadFile>,\n    },\n    trigger: {\n      type: Function as PropType<(e: MouseEvent) => void>,\n    },\n    remove: {\n      type: Function as PropType<(options: UploadRemoveOptions) => void>,\n    },\n    multiple: Boolean,\n    max: Number,\n    disabled: Boolean,\n  },\n\n  computed: {\n    showTrigger(): boolean {\n      if (this.multiple) {\n        return !this.max || this.files.length < this.max;\n      }\n      return !(this.files && this.files[0]);\n    },\n  },\n\n  methods: {\n    onMaskClick(e: MouseEvent) {\n      !this.showTrigger && this.trigger(e);\n    },\n    onViewClick(e: MouseEvent, file?: UploadFile) {\n      this.$emit('imgPreview', e, file);\n    },\n  },\n\n  render() {\n    return (\n      <ul class={`${UPLOAD_NAME}__card`}>\n        {this.files\n          && this.files.map((file, index) => (\n            <li class={`${UPLOAD_NAME}__card-item ${prefix}-is--background`}>\n              <div class={`${UPLOAD_NAME}__card-content ${UPLOAD_NAME}__card-box`}>\n                <img class={`${UPLOAD_NAME}__card-image`} src={file.url} />\n                <div class={`${UPLOAD_NAME}__card-mask`} onClick={this.onMaskClick}>\n                  <span class={`${UPLOAD_NAME}__card-mask-item`} onClick={(e: MouseEvent) => e.stopPropagation()}>\n                    <BrowseIcon nativeOnClick={(e: MouseEvent) => this.onViewClick(e, file)} />\n                  </span>\n                  {!this.disabled && [\n                    <span class={`${UPLOAD_NAME}__card-mask-item-divider`} key=\"divider\"></span>,\n                    <span\n                      class={`${UPLOAD_NAME}__card-mask-item`}\n                      onClick={(e: MouseEvent) => e.stopPropagation()}\n                      key=\"delete-icon\"\n                    >\n                      <DeleteIcon nativeOnClick={(e: MouseEvent) => this.remove({ e, file, index })} />\n                    </span>,\n                  ]}\n                </div>\n              </div>\n            </li>\n          ))}\n        {this.showTrigger && (\n          <li\n            class={[\n              `${UPLOAD_NAME}__card-item ${prefix}-is--background`,\n              {\n                [CLASSNAMES.STATUS.disabled]: this.disabled,\n              },\n            ]}\n            onClick={this.trigger}\n          >\n            {this.showUploadProgress && this.loadingFile && this.loadingFile.status === 'progress' ? (\n              <div class={`${UPLOAD_NAME}__card-container ${UPLOAD_NAME}__card-box`}>\n                <TLoading />\n                <p>上传中 {Math.min(this.loadingFile.percent, 99)}%</p>\n              </div>\n            ) : (\n              <div class={`${UPLOAD_NAME}__card-container ${UPLOAD_NAME}__card-box`}>\n                <AddIcon></AddIcon>\n                <p class={`${prefix}-size-s`}>点击上传图片</p>\n              </div>\n            )}\n          </li>\n        )}\n      </ul>\n    );\n  },\n});\n"],"names":["Vue","extend","name","components","AddIcon","DeleteIcon","BrowseIcon","TLoading","props","showUploadProgress","files","type","Array","loadingFile","Object","trigger","Function","remove","multiple","Boolean","max","Number","disabled","computed","showTrigger","length","methods","onMaskClick","e","onViewClick","file","$emit","render","UPLOAD_NAME","map","index","prefix","url","stopPropagation","CLASSNAMES","STATUS","status","Math","min","percent"],"mappings":"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"}