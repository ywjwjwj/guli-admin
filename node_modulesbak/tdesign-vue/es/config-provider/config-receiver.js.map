{"version":3,"file":"config-receiver.js","sources":["../../src/config-provider/config-receiver.ts"],"sourcesContent":["import Vue, { VueConstructor } from 'vue';\nimport mergeWith from 'lodash/mergeWith';\nimport defaultConfig from './zh_CN_config';\nimport { GlobalConfigProvider, AnimationType } from './type';\n\nexport type ValueOf<T> = T[keyof T];\n\nexport type ComponentConfigType = ValueOf<GlobalConfigProvider>;\n\nexport * from './type';\n\nexport type ConfigRule<T = any> = string | ((args: T) => string);\nexport interface Placement {\n  [propName: string]: string | number;\n}\n\nexport interface ConfigComponent extends Vue {\n  globalConfig: GlobalConfigProvider;\n}\n\nexport default function getConfigReceiverMixins<BasicComponent extends Vue, C extends ComponentConfigType>(\n  componentName: string,\n) {\n  // eslint-disable-line\n  return (Vue as VueConstructor<ConfigComponent & BasicComponent>).extend({\n    name: 'TConfigProvider',\n    inject: {\n      globalConfig: {\n        default: undefined,\n      },\n    },\n\n    computed: {\n      global(): C {\n        const defaultData = defaultConfig[componentName];\n        if (this.globalConfig && this.globalConfig[componentName]) {\n          return {\n            ...defaultData,\n            ...this.globalConfig[componentName],\n          };\n        }\n        return defaultData;\n      },\n    },\n\n    methods: {\n      t<T>(pattern: T, placement?: Placement): string {\n        if (typeof pattern === 'string') {\n          if (!placement) return pattern;\n          const regx = /\\{\\s*([\\w-]+)\\s*\\}/g;\n          const translated = pattern.replace(regx, (match, key) => {\n            if (placement) {\n              return String(placement[key]);\n            }\n            return '';\n          });\n          return translated;\n        }\n        if (typeof pattern === 'function') {\n          return pattern(placement);\n        }\n        return '';\n      },\n    },\n  });\n}\n\nexport function getKeepAnimationMixins<BasicComponent extends Vue>() {\n  return (Vue as VueConstructor<ConfigComponent & BasicComponent>).extend({\n    name: 'TKeepAnimation',\n    inject: {\n      globalConfig: {\n        default: undefined,\n      },\n    },\n    computed: {\n      keepAnimation() {\n        let animationConfig: Record<'include' | 'exclude', Array<AnimationType>> = {\n          include: ['ripple', 'expand', 'fade'],\n          exclude: [],\n        };\n        if (this.globalConfig && this.globalConfig.animation) {\n          // deal with https://github.com/lodash/lodash/issues/1313\n          animationConfig = mergeWith(animationConfig, this.globalConfig.animation, (objValue, srcValue) => {\n            if (Array.isArray(objValue)) {\n              return srcValue;\n            }\n          });\n        }\n        const isKeep = (type: AnimationType) => animationConfig && !animationConfig.exclude.includes(type) && animationConfig.include.includes(type);\n        return {\n          ripple: isKeep('ripple'),\n          expand: isKeep('expand'),\n          fade: isKeep('fade'),\n        };\n      },\n    },\n  });\n}\n"],"names":["getConfigReceiverMixins","componentName","Vue","extend","name","inject","globalConfig","computed","global","defaultData","defaultConfig","methods","t","pattern","placement","regx","translated","replace","match","key","String","getKeepAnimationMixins","keepAnimation","animationConfig","include","exclude","animation","mergeWith","objValue","srcValue","Array","isArray","isKeep","type","includes","ripple","expand","fade"],"mappings":"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"}