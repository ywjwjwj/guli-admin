{"version":3,"file":"useDefaultValue.js","sources":["../../src/hooks/useDefaultValue.ts"],"sourcesContent":["import { ref, Ref, getCurrentInstance } from '@vue/composition-api';\n\nexport type ChangeHandler<T, P extends any[]> = (value: T, ...args: P) => void;\n\nexport default function useDefaultValue<T, P extends any[]>(\n  value: Ref<T>,\n  defaultValue: T,\n  onChange: ChangeHandler<T, P>,\n  // emit 和 propsName 用于支持 .sync 语法糖。而 eventName 用于支持 @change 类型的事件\n  propsName: string,\n  eventName: string,\n): [Ref<T>, ChangeHandler<T, P>] {\n  const { emit } = getCurrentInstance();\n\n  const internalValue = ref();\n  internalValue.value = defaultValue;\n\n  // 受控模式\n  if (typeof value.value !== 'undefined') {\n    return [\n      value,\n      (newValue, ...args) => {\n        emit(`update:${propsName}`, newValue, ...args);\n        onChange?.(newValue, ...args);\n        emit(eventName, newValue, ...args);\n      },\n    ];\n  }\n\n  // 非受控模式\n  return [\n    internalValue,\n    (newValue, ...args) => {\n      internalValue.value = newValue;\n      emit(eventName, newValue, ...args);\n      onChange?.(newValue, ...args);\n    },\n  ];\n}\n"],"names":["useDefaultValue","value","defaultValue","onChange","propsName","eventName","getCurrentInstance","emit","internalValue","ref","newValue","args"],"mappings":";;;;;;;;AACe,SAASA,eAAT,CAAyBC,KAAzB,EAAgCC,YAAhC,EAA8CC,QAA9C,EAAwDC,SAAxD,EAAmEC,SAAnE,EAA8E;AAC3F,EAAA,IAAA,mBAAA,GAAiBC,kBAAkB,EAAnC;AAAA,MAAQC,IAAR,uBAAQA,IAAR,CAAA;;AACA,EAAMC,IAAAA,aAAa,GAAGC,GAAG,EAAzB,CAAA;AACAD,EAAAA,aAAa,CAACP,KAAd,GAAsBC,YAAtB,CAAA;;AACA,EAAA,IAAI,OAAOD,KAAK,CAACA,KAAb,KAAuB,WAA3B,EAAwC;AACtC,IAAA,OAAO,CACLA,KADK,EAEL,UAACS,QAAD,EAAuB;AAAA,MAAA,KAAA,IAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAATC,IAAS,GAAA,IAAA,KAAA,CAAA,IAAA,GAAA,CAAA,GAAA,IAAA,GAAA,CAAA,GAAA,CAAA,CAAA,EAAA,IAAA,GAAA,CAAA,EAAA,IAAA,GAAA,IAAA,EAAA,IAAA,EAAA,EAAA;AAATA,QAAAA,IAAS,CAAA,IAAA,GAAA,CAAA,CAAA,GAAA,SAAA,CAAA,IAAA,CAAA,CAAA;AAAA,OAAA;;AACrBJ,MAAAA,IAAI,CAAJ,KAAA,CAAA,KAAA,CAAA,EAAA,CAAA,SAAA,CAAA,MAAA,CAAeH,SAAf,CAA4BM,EAAAA,QAA5B,SAAyCC,IAAzC,CAAA,CAAA,CAAA;AACAR,MAAAA,QAAQ,KAAR,IAAA,IAAAA,QAAQ,KAAA,KAAA,CAAR,GAAAA,KAAAA,CAAAA,GAAAA,QAAQ,CAAR,KAAA,CAAA,KAAA,CAAA,EAAA,CAAWO,QAAX,CAAA,CAAA,MAAA,CAAwBC,IAAxB,CAAA,CAAA,CAAA;AACAJ,MAAAA,IAAI,CAAJ,KAAA,CAAA,KAAA,CAAA,EAAA,CAAKF,SAAL,EAAgBK,QAAhB,SAA6BC,IAA7B,CAAA,CAAA,CAAA;AACD,KANI,CAAP,CAAA;AAQD,GAAA;;AACD,EAAA,OAAO,CACLH,aADK,EAEL,UAACE,QAAD,EAAuB;AACrBF,IAAAA,aAAa,CAACP,KAAd,GAAsBS,QAAtB,CAAA;;AADqB,IAAA,KAAA,IAAA,KAAA,GAAA,SAAA,CAAA,MAAA,EAATC,IAAS,GAAA,IAAA,KAAA,CAAA,KAAA,GAAA,CAAA,GAAA,KAAA,GAAA,CAAA,GAAA,CAAA,CAAA,EAAA,KAAA,GAAA,CAAA,EAAA,KAAA,GAAA,KAAA,EAAA,KAAA,EAAA,EAAA;AAATA,MAAAA,IAAS,CAAA,KAAA,GAAA,CAAA,CAAA,GAAA,SAAA,CAAA,KAAA,CAAA,CAAA;AAAA,KAAA;;AAErBJ,IAAAA,IAAI,CAAJ,KAAA,CAAA,KAAA,CAAA,EAAA,CAAKF,SAAL,EAAgBK,QAAhB,SAA6BC,IAA7B,CAAA,CAAA,CAAA;AACAR,IAAAA,QAAQ,KAAR,IAAA,IAAAA,QAAQ,KAAA,KAAA,CAAR,GAAAA,KAAAA,CAAAA,GAAAA,QAAQ,CAAR,KAAA,CAAA,KAAA,CAAA,EAAA,CAAWO,QAAX,CAAA,CAAA,MAAA,CAAwBC,IAAxB,CAAA,CAAA,CAAA;AACD,GANI,CAAP,CAAA;AAQD;;;;"}