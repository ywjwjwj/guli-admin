{"version":3,"file":"menu-item.js","sources":["../../src/menu/menu-item.tsx"],"sourcesContent":["import {\n  defineComponent, computed, inject, onMounted,\n} from '@vue/composition-api';\nimport { prefix } from '../config';\nimport props from './menu-item-props';\nimport { TdMenuInterface, TdSubMenuInterface } from './const';\nimport ripple from '../utils/ripple';\nimport { renderContent, renderTNodeJSX } from '../utils/render-tnode';\nimport { getKeepAnimationMixins } from '../config-provider/config-receiver';\nimport { AnimationType } from '../config-provider/type';\n\nconst keepAnimationMixins = getKeepAnimationMixins();\n\nexport default defineComponent({\n  name: 'TMenuItem',\n  mixins: [keepAnimationMixins],\n  props: { ...props },\n  directives: { ripple },\n  setup(props, ctx) {\n    const menu = inject<TdMenuInterface>('TdMenu');\n    const submenu = inject<TdSubMenuInterface>('TdSubmenu', null);\n    const active = computed(() => menu.activeValue.value === props.value);\n    const classes = computed(() => [\n      `${prefix}-menu__item`,\n      {\n        [`${prefix}-is-active`]: active.value,\n        [`${prefix}-is-disabled`]: props.disabled,\n        [`${prefix}-menu__item--plain`]: !ctx.slots.icon && !props.icon,\n        [`${prefix}-submenu__item`]: !!submenu && !menu.isHead,\n      },\n    ]);\n    // methods\n    const handleClick = () => {\n      if (props.disabled) return;\n      menu.select(props.value);\n      ctx.emit('click');\n\n      if (props.href) {\n        window.open(props.href, props.target);\n      } else if (props.to) {\n        const router = props.router || (ctx.root as Record<string, any>).$router;\n        const methods: string = props.replace ? 'replace' : 'push';\n        router[methods](props.to).catch((err: Error) => {\n          // vue-router 3.1.0+ push/replace cause NavigationDuplicated error\n          // https://github.com/vuejs/vue-router/issues/2872\n          // 当前path和目标path相同时，会抛出NavigationDuplicated的错误\n          if (\n            err.name !== 'NavigationDuplicated'\n            && !err.message.includes('Avoided redundant navigation to current location')\n          ) {\n            throw err;\n          }\n        });\n      }\n    };\n\n    // lifetimes\n    onMounted(() => {\n      menu?.vMenu?.add({\n        value: props.value,\n        parent: submenu?.value,\n        vnode: ctx.slots.default && ctx.slots.default(),\n      });\n    });\n\n    return {\n      menu,\n      active,\n      classes,\n      handleClick,\n    };\n  },\n  render() {\n    return (\n      <li\n        v-ripple={(this.keepAnimation as Record<AnimationType, boolean>).ripple}\n        class={this.classes}\n        onClick={this.handleClick}\n      >\n        {renderTNodeJSX(this, 'icon')}\n        <span class={[`${prefix}-menu__content`]}>{renderContent(this, 'default', 'content')}</span>\n      </li>\n    );\n  },\n});\n"],"names":["keepAnimationMixins","getKeepAnimationMixins","defineComponent","name","mixins","props","directives","ripple","setup","props2","ctx","menu","inject","submenu","active","computed","activeValue","value","classes","prefix","disabled","slots","icon","isHead","handleClick","select","emit","href","window","open","target","to","router","root","$router","methods","replace","err","message","includes","onMounted","vMenu","add","parent","vnode","render","keepAnimation","renderTNodeJSX","renderContent"],"mappings":"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"}