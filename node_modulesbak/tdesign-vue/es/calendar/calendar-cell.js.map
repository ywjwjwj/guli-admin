{"version":3,"file":"calendar-cell.js","sources":["../../src/calendar/calendar-cell.tsx"],"sourcesContent":["// 通用库\nimport dayjs from 'dayjs';\nimport Vue, { VNode, PropType } from 'vue';\nimport { prefix } from '../config';\n// 组件的一些常量\nimport { COMPONENT_NAME } from './const';\n\n// 组件相关的自定义类型\nimport { CalendarCell, TdCalendarProps } from './type';\nimport { renderTNodeJSXDefault, renderTNodeJSX } from '../utils/render-tnode';\n\nconst clickTypeEmitEventMap = {\n  click: 'click',\n  dblclick: 'dblclick',\n  contextmenu: 'rightclick',\n};\n\nexport default Vue.extend({\n  name: `${COMPONENT_NAME}-cell`,\n  props: {\n    item: {\n      type: Object as PropType<CalendarCell>,\n      default: (): CalendarCell => null,\n    },\n    theme: {\n      type: String as PropType<TdCalendarProps['theme']>,\n      default: (): string => null,\n    },\n    fillWithZero: {\n      type: Boolean,\n      default: undefined,\n    },\n    t: Function,\n    global: Object,\n    cell: Function as PropType<TdCalendarProps['cell']>,\n  },\n  computed: {\n    allowSlot(): boolean {\n      return this.theme === 'full';\n    },\n    disabled(): boolean {\n      return this.item.mode === 'month' && this.item.belongTo !== 0;\n    },\n    valueDisplay(): string | number {\n      if (this.item.mode === 'month') {\n        const dateNum = this.item.date.getDate();\n        const fillZero = dateNum < 10 && (this.fillWithZero ?? this.global.fillWithZero ?? true);\n        return fillZero ? `0${dateNum}` : dateNum;\n      }\n      const map = this.t(this.global.cellMonth).split(',');\n      return map[this.item.date.getMonth().toString()];\n    },\n    cellCls(): Record<string, any> {\n      const {\n        mode, date, formattedDate, isCurrent,\n      } = this.item;\n      const isNow = mode === 'year' ? new Date().getMonth() === date.getMonth() : formattedDate === dayjs().format('YYYY-MM-DD');\n      return [\n        `${prefix}-calendar__table-body-cell`,\n        {\n          [`${prefix}-is-disabled`]: this.disabled,\n          [`${prefix}-is-checked`]: isCurrent,\n          [`${prefix}-calendar__table-body-cell--now`]: isNow,\n        },\n      ];\n    },\n  },\n  methods: {\n    clickCell(e: MouseEvent) {\n      if (this.disabled) return;\n      this.$emit(clickTypeEmitEventMap[e.type], e);\n    },\n  },\n  render(): VNode {\n    const {\n      item, cellCls, clickCell, valueDisplay, allowSlot,\n    } = this;\n\n    const defaultNode = () => (\n      <span>\n        <div class={`${prefix}-calendar__table-body-cell-display`}>{valueDisplay}</div>\n        <div class={`${prefix}-calendar__table-body-cell-content`}>\n          {allowSlot\n            && renderTNodeJSX(this, 'cellAppend', {\n              params: item,\n            })}\n        </div>\n      </span>\n    );\n\n    return (\n      item && (\n        <div class={cellCls} onClick={clickCell} ondblclick={clickCell} onContextmenu={clickCell}>\n          {typeof this.cell === 'function'\n            ? this.cell(this.$createElement, item)\n            : renderTNodeJSXDefault(this, 'cell', {\n              defaultNode: defaultNode(),\n              params: item,\n            })}\n        </div>\n      )\n    );\n  },\n});\n"],"names":["clickTypeEmitEventMap","click","dblclick","contextmenu","Vue","extend","name","COMPONENT_NAME","props","item","type","Object","theme","String","fillWithZero","Boolean","t","Function","global","cell","computed","allowSlot","disabled","mode","belongTo","valueDisplay","dateNum","date","getDate","fillZero","map","cellMonth","split","getMonth","toString","cellCls","formattedDate","isCurrent","isNow","Date","dayjs","format","prefix","methods","clickCell","e","$emit","render","defaultNode","renderTNodeJSX","params","$createElement","renderTNodeJSXDefault"],"mappings":"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"}