{"version":3,"file":"time-picker.js","sources":["../../src/time-picker/time-picker.tsx"],"sourcesContent":["import dayjs from 'dayjs';\nimport isFunction from 'lodash/isFunction';\nimport customParseFormat from 'dayjs/plugin/customParseFormat';\n\nimport { TimeIcon } from 'tdesign-icons-vue';\nimport mixins from '../utils/mixins';\nimport getConfigReceiverMixins, { TimePickerConfig } from '../config-provider/config-receiver';\nimport {\n  TimePickerInstance,\n  TimePickerPanelInstance,\n  TimeInputEvent,\n  InputTime,\n  TimeInputType,\n  EPickerCols,\n} from './interface';\nimport TPopup, { PopupVisibleChangeContext } from '../popup';\nimport { prefix } from '../config';\nimport CLASSNAMES from '../utils/classnames';\nimport PickerPanel from './panel';\nimport TInput from '../input';\n\nimport InputItems from './input-items';\n\nimport props from './props';\n\nimport {\n  EMPTY_VALUE, componentName, AM_FORMAT, PM_Format, AM,\n} from './constant';\n\nconst name = `${prefix}-time-picker`;\n\ndayjs.extend(customParseFormat);\n\nexport default mixins(getConfigReceiverMixins<TimePickerInstance, TimePickerConfig>('timePicker')).extend({\n  name: 'TTimePicker',\n\n  components: {\n    PickerPanel,\n    TimeIcon,\n    TPopup,\n    TInput,\n    InputItems,\n  },\n  model: {\n    prop: 'value',\n    event: 'change',\n  },\n\n  props: { ...props },\n\n  data() {\n    const { defaultValue, value } = this.$props;\n    // 初始化默认值\n    const time = value || defaultValue;\n    // 初始化数据\n    return {\n      // 表单控制禁用态时的变量\n      formDisabled: undefined,\n      els: [],\n      focus: false,\n      isShowPanel: false,\n      // 时间对象\n      time: time ? dayjs(time, this.format) : undefined,\n      // 初始值转input展示对象\n      inputTime: time ? this.setInputValue(dayjs(time, this.format)) : undefined,\n      needClear: false,\n    };\n  },\n\n  computed: {\n    tDisabled(): boolean {\n      return this.formDisabled || this.disabled;\n    },\n    // 传递给选择面板的时间值\n    panelValue(): Array<dayjs.Dayjs> {\n      const {\n        $data: { time },\n      } = this;\n      if (time) {\n        return [dayjs(time, this.format)];\n      }\n      if (this.steps.filter((step) => step !== 1).length < 1) {\n        return [dayjs()];\n      }\n      return [dayjs().hour(0).minute(0).second(0)];\n    },\n    textClassName(): string {\n      const isDefault = (this.inputTime as any).some(\n        (item: InputTime) => !!item.hour && !!item.minute && !!item.second,\n      );\n      return isDefault ? '' : `${name}__group-text`;\n    },\n  },\n\n  watch: {\n    // 监听选中时间变动\n    time: {\n      handler() {\n        this.output();\n      },\n    },\n    value: {\n      handler() {\n        this.time = this.value ? dayjs(this.value, this.format) : undefined;\n        this.inputTime = this.value ? this.setInputValue(dayjs(this.value, this.format)) : undefined;\n      },\n    },\n  },\n  methods: {\n    // 输入变化\n    inputChange(event: TimeInputEvent) {\n      const { type, value } = event;\n      const {\n        $data: {\n          // 鉴别是range还是单picker\n          time,\n        },\n      } = this;\n      let newTime = time;\n      if (value === EMPTY_VALUE) {\n        // 特殊标识，需要清空input\n        this.inputTime[type] = undefined;\n        // 需要重置该类型时间\n        newTime[type](0);\n        return;\n      }\n      if (!newTime) {\n        // 默认值不存在\n        newTime = dayjs();\n        newTime.hour(0);\n        newTime.minute(0);\n        newTime.second(0);\n      }\n      // 设置时间\n      newTime = newTime.set(type, value);\n      // 生成变动\n      this.time = dayjs(newTime);\n      // 转化展示数据\n      this.inputTime = this.setInputValue(this.time);\n      this.$emit('input', { input: value, value: this.time.format(this.format), e: event });\n      const panelRef = this.$refs.panel as TimePickerPanelInstance;\n      panelRef.panelColUpdate();\n    },\n    // @blur\n    onBlurDefault(e: Event, trigger: TimeInputType, index: number, input: number) {\n      this.$emit('blur', {\n        trigger,\n        input,\n        value: this.time.format(this.format),\n        e,\n      });\n    },\n    // @focus\n    onFocusDefault(e: Event, trigger: TimeInputType, index: number, input: number) {\n      this.$emit('focus', {\n        trigger,\n        input,\n        value: this.time.format(this.format),\n        e,\n      });\n    },\n    // 面板展示隐藏\n    panelVisibleChange(val: boolean, context?: PopupVisibleChangeContext) {\n      if (this.tDisabled) return;\n      if (context.trigger) {\n        const isClickDoc = context.trigger === 'document';\n        this.isShowPanel = !isClickDoc;\n        this.$emit(isClickDoc ? 'close' : 'open', context);\n      } else {\n        this.isShowPanel = val;\n        this.$emit(val ? 'open' : 'close', context);\n      }\n    },\n    // 切换上下午\n    toggleInputMeridiem() {\n      const {\n        $data: { time },\n      } = this;\n      const current = time.format('A');\n      const currentHour = time.hour() + (current === AM ? 12 : -12);\n      // 时间变动\n      this.inputChange({\n        type: 'hour',\n        value: currentHour,\n      });\n    },\n    // 选中时间发生变动\n    pickTime(col: EPickerCols, change: string | number, index: number, value: Record<string, any>) {\n      const { time, format } = this;\n      let setTime = time;\n\n      if (EPickerCols.hour === col) {\n        setTime = value.set(\n          col,\n          value.hour() >= 12 && (AM_FORMAT.test(format) || PM_Format.test(format)) ? Number(change) + 12 : change,\n        );\n      } else if ([EPickerCols.minute, EPickerCols.second].includes(col)) {\n        setTime = value.set(col, change);\n      } else {\n        // 当前上下午\n        let currentHour = value.hour();\n        // 上下午\n        if (change === this.global.anteMeridiem && currentHour > 12) {\n          // 上午\n          currentHour -= 12;\n        } else if (change === this.global.postMeridiem && currentHour < 12) {\n          // 下午\n          currentHour += 12;\n        }\n        setTime = value.hour(currentHour);\n      }\n      this.time = setTime;\n\n      this.inputTime = this.setInputValue(setTime);\n      const formatValue = dayjs(setTime).format(this.format);\n      this.$emit('change', formatValue);\n    },\n    // 确定按钮\n    makeSure(e: MouseEvent) {\n      this.panelVisibleChange(false, { e });\n      this.output();\n    },\n    // 此刻按钮\n    nowAction() {\n      const currentTime = dayjs();\n      // 如果此刻在不可选的时间上, 直接return\n      if (\n        isFunction(this.disableTime)\n        && this.disableTime(currentTime.get('hour'), currentTime.get('minute'), currentTime.get('second'))\n      ) {\n        return;\n      }\n      this.time = currentTime;\n      this.inputTime = this.setInputValue(this.time);\n      this.$emit('change', currentTime.format(this.format));\n    },\n    // format输出结果\n    output() {\n      if (this.needClear) {\n        this.inputTime = this.setInputValue(undefined);\n        this.needClear = false;\n      } else {\n        this.time = this.time ?? dayjs();\n        this.inputTime = this.setInputValue(this.time);\n      }\n    },\n    // 设置输入框展示\n    setInputValue(val: dayjs.Dayjs | undefined): InputTime | undefined {\n      const ans: InputTime = {\n        hour: undefined,\n        minute: undefined,\n        second: undefined,\n        meridiem: AM,\n      };\n      if (!val) return ans;\n      return this.dayjs2InputTime(val);\n    },\n    // dayjs对象转换输入展示数据\n    dayjs2InputTime(val: dayjs.Dayjs): InputTime {\n      const {\n        $props: { format },\n      } = this;\n      if (!val) {\n        return {\n          hour: undefined,\n          minute: undefined,\n          second: undefined,\n          meridiem: AM,\n        };\n      }\n\n      let hour: number | string = val.hour();\n      let minute: number | string = val.minute();\n      let second: number | string = val.second();\n      // 判断12小时制上下午显示问题\n      if (/[h]{1}/.test(format)) {\n        hour %= 12;\n      }\n      // 判定是否补齐小于10\n      if (/[h|H]{2}/.test(format)) {\n        hour = hour < 10 ? `0${hour}` : hour;\n      }\n      if (/[m|M]{2}/.test(format)) {\n        minute = minute < 10 ? `0${minute}` : minute;\n      }\n      if (/[s|S]{2}/.test(format)) {\n        second = second < 10 ? `0${second}` : second;\n      }\n\n      return {\n        hour,\n        minute,\n        second,\n        meridiem: val.format('a'),\n      };\n    },\n    // 清除选中\n    clear(context: { e: MouseEvent }) {\n      const { e } = context;\n      this.time = undefined;\n      this.needClear = true;\n      this.inputTime = this.setInputValue(undefined);\n      this.$emit('change', undefined);\n      e.stopPropagation();\n    },\n    handleTInputFocus() {\n      // TODO: 待改成select-input后删除\n      // hack 在input聚焦时马上blur 避免出现输入光标\n      (this.$refs.tInput as HTMLInputElement).blur();\n    },\n    renderInput() {\n      const classes = [\n        `${name}__group`,\n        {\n          [`${prefix}-is-focused`]: this.isShowPanel,\n        },\n      ];\n      return (\n        <div class={classes}>\n          <t-input\n            disabled={this.tDisabled}\n            size={this.size}\n            onClear={this.clear}\n            clearable={this.clearable}\n            placeholder=\" \"\n            value={this.time ? ' ' : undefined}\n            onFocus={this.handleTInputFocus}\n            ref=\"tInput\"\n          >\n            <time-icon slot=\"suffix-icon\"></time-icon>\n          </t-input>\n          <input-items\n            size={this.size}\n            dayjs={this.inputTime}\n            disabled={this.tDisabled}\n            format={this.format}\n            steps={this.steps}\n            allowInput={this.allowInput}\n            placeholder={this.placeholder || this.global.placeholder}\n            onToggleMeridiem={() => this.toggleInputMeridiem()}\n            onBlurDefault={this.onBlurDefault}\n            onFocusDefault={this.onFocusDefault}\n            onChange={(e: TimeInputEvent) => this.inputChange(e)}\n          />\n        </div>\n      );\n    },\n  },\n\n  render() {\n    // 初始化数据\n    const {\n      $props: { size, className, tDisabled },\n    } = this;\n    // 样式类名\n    const classes = [name, CLASSNAMES.SIZE[size] || '', className];\n\n    return (\n      <t-popup\n        ref=\"popup\"\n        placement=\"bottom-left\"\n        class={classes}\n        trigger=\"click\"\n        disabled={tDisabled}\n        visible={this.isShowPanel}\n        overlayClassName={`${componentName}__panel-container`}\n        on={{ 'visible-change': this.panelVisibleChange }}\n        expandAnimation={true}\n      >\n        {this.renderInput()}\n        <template slot=\"content\">\n          <picker-panel\n            ref=\"panel\"\n            format={this.format}\n            value={this.panelValue}\n            disabled={this.tDisabled}\n            isShowPanel={this.isShowPanel}\n            ontime-pick={this.pickTime}\n            onsure={this.makeSure}\n            onnow-action={this.nowAction}\n            steps={this.steps}\n            hideDisabledTime={this.hideDisabledTime}\n            disableTime={this.disableTime}\n            isFocus={this.focus}\n          />\n        </template>\n      </t-popup>\n    );\n  },\n});\n"],"names":["name","prefix","dayjs","extend","customParseFormat","mixins","getConfigReceiverMixins","components","PickerPanel","TimeIcon","TPopup","TInput","InputItems","model","prop","event","props","data","$props","defaultValue","value","time","formDisabled","els","focus","isShowPanel","format","inputTime","setInputValue","needClear","computed","tDisabled","disabled","panelValue","$data","steps","filter","step","length","hour","minute","second","textClassName","isDefault","some","item","watch","handler","output","methods","inputChange","type","newTime","EMPTY_VALUE","set","$emit","input","e","panelRef","$refs","panel","panelColUpdate","onBlurDefault","trigger","index","onFocusDefault","panelVisibleChange","val","context","isClickDoc","toggleInputMeridiem","current","currentHour","AM","pickTime","col","change","setTime","EPickerCols","AM_FORMAT","test","PM_Format","Number","includes","global","anteMeridiem","postMeridiem","formatValue","makeSure","nowAction","currentTime","isFunction","disableTime","get","ans","meridiem","dayjs2InputTime","clear","stopPropagation","handleTInputFocus","tInput","blur","renderInput","classes","size","clearable","allowInput","placeholder","render","className","CLASSNAMES","SIZE","_mergeJSXProps","componentName","hideDisabledTime"],"mappings":"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"}