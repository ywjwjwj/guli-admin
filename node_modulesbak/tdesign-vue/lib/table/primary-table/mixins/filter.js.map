{"version":3,"file":"filter.js","sources":["../../../../src/table/primary-table/mixins/filter.tsx"],"sourcesContent":["import Vue, { CreateElement } from 'vue';\nimport isFunction from 'lodash/isFunction';\nimport { FilterIcon } from 'tdesign-icons-vue';\nimport { PrimaryTableCol, TdPrimaryTableProps, FilterValue } from '../../type';\nimport primaryTableProps from '../../primary-table-props';\nimport baseTableProps from '../../base-table-props';\nimport { prefix } from '../../../config';\nimport { CheckboxGroup } from '../../../checkbox';\nimport { RadioGroup } from '../../../radio';\nimport Input from '../../../input';\nimport Popup from '../../../popup';\nimport TButton from '../../../button';\nimport { getTitle } from '../../util/common';\nimport { emitEvent } from '../../../utils/event';\nimport { renderTNodeJSXDefault } from '../../../utils/render-tnode';\n\ntype FilterChangeContext = Parameters<TdPrimaryTableProps['onFilterChange']>;\ntype ChangeContext = Parameters<TdPrimaryTableProps['onChange']>;\n\ntype Params = Parameters<CreateElement>;\ntype FirstParams = Params[0];\ntype SecondParams = Params[1] | Params[2];\n\n// 筛选条件不为空，才需要显示筛选结果行\nfunction filterEmptyData(data: FilterValue) {\n  const newFilterValue: FilterValue = {};\n  Object.keys(data).forEach((key) => {\n    const item = data[key];\n    const isArrayTrue = item instanceof Array && item.length;\n    const isObject = typeof item === 'object' && !(item instanceof Array);\n    const isObjectTrue = isObject && Object.keys(item).length;\n    if (isArrayTrue || isObjectTrue || !['null', '', 'undefined'].includes(String(item))) {\n      newFilterValue[key] = item;\n    }\n  });\n  return newFilterValue;\n}\n\nexport default Vue.extend({\n  name: `${prefix}-primary-table-filter`,\n\n  data() {\n    return {\n      tableWidth: 0,\n      innerFilterValue: this.filterValue,\n      filterPopupVisible: {},\n    };\n  },\n\n  props: {\n    columns: primaryTableProps.columns,\n    pagination: baseTableProps.pagination,\n    filterValue: primaryTableProps.filterValue,\n    filterIcon: primaryTableProps.filterIcon,\n    data: baseTableProps.data,\n    filterRow: Function,\n  },\n\n  computed: {\n    fixedLeftColumn(): boolean {\n      return !!this.columns?.filter((col) => col.fixed === 'left').length;\n    },\n    hasFilterCondition(): boolean {\n      return !!this.columns?.filter((col) => col.filter).length;\n    },\n  },\n\n  watch: {\n    filterValue(val) {\n      this.innerFilterValue = { ...val };\n    },\n  },\n\n  mounted() {\n    // using timer for getting right width\n    let timer = setTimeout(() => {\n      this.updateTableWidth();\n      clearTimeout(timer);\n      timer = null;\n    }, 0);\n  },\n\n  methods: {\n    updateTableWidth() {\n      if (!this.$el) return;\n      const tbody = this.$el?.querySelector(`.${prefix}-table__body`);\n      if (tbody) {\n        this.tableWidth = tbody.clientWidth;\n      } else {\n        const el = this.$el.querySelector(`.${prefix}-table-content`);\n        el && (this.tableWidth = el.clientWidth);\n      }\n    },\n\n    onFilterPopupVisibleChange(visible: boolean, colKey: string) {\n      this.$set(this.filterPopupVisible, colKey, visible);\n    },\n\n    renderFirstFilterRow() {\n      const filterEmpty = filterEmptyData(this.filterValue);\n      if (!this.filterValue || !Object.keys(filterEmpty).length) return null;\n      const defaultNode = (\n        <div class={`${prefix}-table__filter-result`}>\n          <span>搜索 “{this.getFilterResultContent()}”，</span>\n          <span>找到 {this.pagination?.total || this.data?.length} 条结果</span>\n          <TButton theme=\"primary\" variant=\"text\" onClick={this.onResetAll}>\n            清空筛选\n          </TButton>\n        </div>\n      );\n      const filterContent = renderTNodeJSXDefault(this, 'filterRow', {\n        defaultNode,\n      });\n      return (\n        <div\n          style={{ width: this.fixedLeftColumn ? `${this.tableWidth}px` : undefined }}\n          class={`${prefix}-table__row-filter-inner`}\n        >\n          {filterContent}\n        </div>\n      );\n    },\n\n    // 获取搜索条件内容，存在 options 需要获取其 label 显示\n    getFilterResultContent(): string {\n      const arr: string[] = [];\n      this.columns\n        .filter((col) => col.filter)\n        .forEach((col) => {\n          let value = this.filterValue[col.colKey];\n          if (col.filter.list && !['null', '', 'undefined'].includes(String(value))) {\n            const formattedValue = value instanceof Array ? value : [value];\n            const label: string[] = [];\n            col.filter.list.forEach((option) => {\n              if (formattedValue.includes(option.value)) {\n                label.push(option.label);\n              }\n            });\n            value = label.join();\n          }\n          if (value) {\n            arr.push(`${col.title}：${value}`);\n          }\n        });\n      return arr.join('；');\n    },\n\n    onInnerFilterChange(val: any, column: PrimaryTableCol) {\n      const filterValue = {\n        ...this.innerFilterValue,\n        [column.colKey]: val,\n      };\n      this.innerFilterValue = filterValue;\n      if (!column.filter.showConfirmAndReset) {\n        this.emitFilterChange(filterValue, column);\n      }\n    },\n\n    emitFilterChange(filterValue: FilterValue, column?: PrimaryTableCol) {\n      emitEvent<FilterChangeContext>(this, 'filter-change', filterValue, { col: column });\n      emitEvent<ChangeContext>(this, 'change', { filter: filterValue }, { trigger: 'filter' });\n    },\n\n    onReset(column: PrimaryTableCol) {\n      const filterValue: FilterValue = {\n        ...this.innerFilterValue,\n        [column.colKey]:\n          {\n            single: '',\n            multiple: [],\n            input: '',\n          }[column.filter.type]\n          || column.filter.resetValue\n          || '',\n      };\n      this.innerFilterValue = filterValue;\n      this.emitFilterChange(filterValue, column);\n      this.$set(this.filterPopupVisible, column.colKey, false);\n    },\n\n    onResetAll() {\n      this.innerFilterValue = {};\n      this.emitFilterChange({});\n      this.filterPopupVisible = {};\n    },\n\n    onConfirm(column: PrimaryTableCol) {\n      this.emitFilterChange(this.innerFilterValue, column);\n      this.$set(this.filterPopupVisible, column.colKey, false);\n    },\n\n    getBottomButtons(column: PrimaryTableCol) {\n      if (!column.filter.showConfirmAndReset) return;\n      return (\n        <div class={`${prefix}-table__filter--bottom-buttons`}>\n          <TButton theme=\"default\" size=\"small\" onClick={() => this.onReset(column)}>\n            重置\n          </TButton>\n          <TButton theme=\"primary\" size=\"small\" onClick={() => this.onConfirm(column)}>\n            确认\n          </TButton>\n        </div>\n      );\n    },\n\n    getFilterContent(column: PrimaryTableCol) {\n      const types = ['single', 'multiple', 'input'];\n      if (column.type && !types.includes(column.filter.type)) {\n        console.error(`TDesign Table Error: column.filter.type must be the following: ${JSON.stringify(types)}`);\n        return;\n      }\n      if (column?.filter?.component && typeof column?.filter?.component !== 'function') {\n        console.error('TDesign Table Error: column.filter.component must be a function');\n        return;\n      }\n      const component = {\n        single: RadioGroup,\n        multiple: CheckboxGroup,\n        input: Input,\n      }[column.filter.type];\n      if (!component && !column?.filter?.component) return;\n      const props = {\n        options: ['single', 'multiple'].includes(column.filter.type) ? column.filter?.list : undefined,\n        ...(column.filter?.props || {}),\n        value: this.innerFilterValue[column.colKey],\n      };\n      const on = {\n        change: (val: any) => this.onInnerFilterChange(val, column),\n      };\n      return (\n        <div class={`${prefix}-table__filter-pop-content-inner`}>\n          {column?.filter?.component ? (\n            column?.filter?.component((v: FirstParams, b: SecondParams) => {\n              const tProps = typeof b === 'object' && 'attrs' in b ? b.attrs : {};\n              return this.$createElement(v, {\n                props: { ...props, ...tProps },\n                on,\n              });\n            })\n          ) : (\n            <component value={this.innerFilterValue[column.colKey]} props={{ ...props }} on={{ ...on }}></component>\n          )}\n        </div>\n      );\n    },\n\n    getFilterColumns(columns: PrimaryTableCol[]): PrimaryTableCol[] {\n      return columns.map((item, index: number) => {\n        const column: PrimaryTableCol = { ...item };\n        if (column.filter) {\n          const title = getTitle(this, column, index);\n          column.title = () => (\n            <div class={`${prefix}-table__cell--title`}>\n              <div>{title}</div>\n              <div class={`${prefix}-table__cell--filter`}>\n                <Popup\n                  visible={this.filterPopupVisible[column.colKey]}\n                  trigger=\"click\"\n                  placement=\"bottom\"\n                  showArrow\n                  overlayClassName={`${prefix}-table__filter-pop`}\n                  on={{\n                    'visible-change': (val: boolean) => this.onFilterPopupVisibleChange(val, column.colKey),\n                  }}\n                >\n                  {isFunction(this.filterIcon) ? (\n                    this.filterIcon(this.$createElement)\n                  ) : (\n                    <FilterIcon name=\"filter\" class={`${prefix}-table__filter-icon`} />\n                  )}\n                  <template slot=\"content\">\n                    <div class={`${prefix}-table__filter-pop-content`}>\n                      {this.getFilterContent(column)}\n                      {this.getBottomButtons(column)}\n                    </div>\n                  </template>\n                </Popup>\n              </div>\n            </div>\n          );\n        }\n        return column;\n      });\n    },\n  },\n});\n"],"names":["filterEmptyData","data","newFilterValue","Object","keys","forEach","key","item","isArrayTrue","Array","length","isObject","_typeof","isObjectTrue","includes","String","Vue","extend","name","prefix","tableWidth","innerFilterValue","filterValue","filterPopupVisible","props","columns","primaryTableProps","pagination","baseTableProps","filterIcon","filterRow","Function","computed","fixedLeftColumn","filter","col","fixed","hasFilterCondition","watch","val","mounted","timer","setTimeout","updateTableWidth","clearTimeout","methods","$el","tbody","querySelector","clientWidth","el","onFilterPopupVisibleChange","visible","colKey","$set","renderFirstFilterRow","filterEmpty","defaultNode","getFilterResultContent","total","TButton","onResetAll","filterContent","renderTNodeJSXDefault","width","arr","value","list","formattedValue","label","option","push","join","title","onInnerFilterChange","column","_defineProperty","showConfirmAndReset","emitFilterChange","emitEvent","trigger","onReset","single","multiple","input","type","resetValue","onConfirm","getBottomButtons","getFilterContent","types","console","error","JSON","stringify","component","RadioGroup","CheckboxGroup","Input","options","on","change","v","b","tProps","attrs","$createElement","_mergeJSXProps","getFilterColumns","map","index","getTitle","Popup","_mergeJSXProps2","isFunction","FilterIcon"],"mappings":"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"}