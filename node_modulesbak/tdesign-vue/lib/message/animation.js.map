{"version":3,"file":"animation.js","sources":["../../src/message/animation.ts"],"sourcesContent":["import { PLACEMENT_LIST } from './const';\n\nconst ANIMATION_OPTION = {\n  duration: 200,\n  easing: 'linear',\n};\n\nfunction fadeIn(dom: HTMLElement, placement: string) {\n  if (!dom) return;\n  const offsetWidth = dom?.offsetWidth || 0;\n  const offsetHeight = dom?.offsetHeight || 0;\n  const fadeInKeyframes: Array<Keyframe> | null = getFadeInKeyframes(placement, offsetWidth, offsetHeight);\n  if (!fadeInKeyframes) return;\n  const styleAfterFadeIn = fadeInKeyframes[fadeInKeyframes.length - 1];\n  setDomStyleAfterAnimation(dom, styleAfterFadeIn);\n  dom.animate && dom.animate(fadeInKeyframes, ANIMATION_OPTION);\n}\n\nfunction fadeOut(dom: HTMLElement, placement: string, onFinish: Function) {\n  if (!dom) return;\n  const offsetHeight = dom?.offsetHeight || 0;\n  const fadeOutKeyframes: Array<Keyframe> | null = getFadeOutKeyframes(placement, offsetHeight);\n  if (!fadeOutKeyframes) return onFinish();\n  const styleAfterFadeOut = fadeOutKeyframes[fadeOutKeyframes.length - 1];\n  setDomStyleAfterAnimation(dom, styleAfterFadeOut);\n\n  const animation = dom.animate && dom.animate(fadeOutKeyframes, ANIMATION_OPTION);\n  if (animation) {\n    animation.onfinish = () => {\n      // eslint-disable-next-line no-param-reassign\n      dom.style.display = 'none';\n      onFinish();\n    };\n  } else {\n    // eslint-disable-next-line no-param-reassign\n    dom.style.display = 'none';\n    onFinish();\n  }\n}\n\nfunction setDomStyleAfterAnimation(dom: HTMLElement, styleAfterAnimation: Keyframe) {\n  const keys = Object.keys(styleAfterAnimation);\n  for (let i = 0; i < keys.length; i += 1) {\n    const key = keys[i];\n    // eslint-disable-next-line no-param-reassign\n    dom.style[key] = styleAfterAnimation[key];\n  }\n}\n\nfunction getFadeInKeyframes(placement: string, offsetWidth: Number, offsetHeight: Number): Array<Keyframe> | null {\n  if (!PLACEMENT_LIST.includes(placement)) return null;\n  if (['top-left', 'left', 'bottom-left'].includes(placement)) {\n    return [\n      { opacity: 0, marginLeft: `-${offsetWidth}px` },\n      { opacity: 1, marginLeft: '0' },\n    ];\n  }\n  if (['top-right', 'right', 'bottom-right'].includes(placement)) {\n    return [\n      { opacity: 0, marginRight: `-${offsetWidth}px` },\n      { opacity: 1, marginRight: '0' },\n    ];\n  }\n  if (['top', 'center'].includes(placement)) {\n    return [\n      { opacity: 0, marginTop: `-${offsetHeight}px` },\n      { opacity: 1, marginTop: '0' },\n    ];\n  }\n  if (['bottom'].includes(placement)) {\n    return [\n      { opacity: 0, transform: `translate3d(0, ${offsetHeight}px, 0)` },\n      { opacity: 1, transform: 'translate3d(0, 0, 0)' },\n    ];\n  }\n}\n\nfunction getFadeOutKeyframes(placement: string, offsetHeight: Number): Array<Keyframe> | null {\n  if (!PLACEMENT_LIST.includes(placement)) return null;\n  if (['bottom-left', 'bottom', 'bottom-right'].includes(placement)) {\n    const marginOffset = `${offsetHeight}px`;\n    return [\n      { opacity: 1, marginTop: '0px' },\n      { opacity: 0, marginTop: marginOffset },\n    ];\n  }\n  const marginOffset = `-${offsetHeight}px`;\n  return [\n    { opacity: 1, marginTop: '0px' },\n    { opacity: 0, marginTop: marginOffset },\n  ];\n}\n\nexport { fadeIn, fadeOut };\n"],"names":["ANIMATION_OPTION","duration","easing","fadeIn","dom","placement","offsetWidth","offsetHeight","fadeInKeyframes","getFadeInKeyframes","styleAfterFadeIn","length","setDomStyleAfterAnimation","animate","fadeOut","onFinish","fadeOutKeyframes","getFadeOutKeyframes","styleAfterFadeOut","animation","onfinish","style","display","styleAfterAnimation","keys","Object","i","key","PLACEMENT_LIST","includes","opacity","marginLeft","marginRight","marginTop","transform","marginOffset2","marginOffset"],"mappings":"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"}